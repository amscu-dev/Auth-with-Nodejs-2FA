openapi: 3.1.0
info:
  title: API for Password, Passkey, Magic Link, and OIDC Authentication
  description: >
    API for user registration and authentication using multiple methods:
    username/password with capability of 2fa, passkey (WebAuthn), magic link, and OIDC providers (Google, GitHub, etc.).
  contact:
    name: Marinescu Alexandru
    email: amarinescu.dev@gmail.com
  license:
    name: Apache License 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0
  version: 1.0.0
servers:
  - url: https://accounts.authportal.com/api/v1
    description: Production Server
paths:
  /auth/register:
    post:
      tags: [âœ‰ï¸ Email & Password Auth]
      summary: Register a new user
      description: This endpoint allows a new user to create an account using their email and password. After registration, the user must verify their email to complete the registration process successfully.
      requestBody:
        required: true
        description: Request body for user registration.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserRegistrationRequestBody"
      responses:
        "201":
          description: Registration successful. A verification email has been sent, the user must confirm their email to complete the signup process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegistrationSuccessReponse"
        "400":
          description: Bad Request â€” validation failed or user already exists.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                EmailAlreadyExistsError:
                  $ref: "#/components/examples/EmailAlreadyExistsErrorExample"
                InvalidRequestBodyValidationError:
                  $ref: "#/components/examples/InvalidRequestBodyValidationErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/EmailAlreadyExistsError"
                  - $ref: "#/components/schemas/InvalidRequestBodyValidationError"
  /auth/login:
    post:
      tags: [âœ‰ï¸ Email & Password Auth]
      summary: Authenticate a user with email and password
      description: >
        This endpoint allows an existing user to log in using their email and password.
        Upon successful authentication, an access token (and optionally a refresh token) is returned.
        If the user has two-factor authentication enabled, additional steps may be required to complete the login process.
      requestBody:
        required: true
        description: Credentials for user login
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserLoginRequestBody"
      responses:
        "200":
          description: >
            Authentication response. Depending on the user's status, one of the following outcomes is returned:
            1. Email not verified â€” user must confirm their email to proceed.
            2. Two-factor authentication required â€” user must complete MFA to finalize login.
            3. Authentication successful â€” user credentials are valid, and access/refresh tokens are provided.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              examples:
                LoginEmailVerificationPendingResponse:
                  $ref: "#/components/examples/LoginEmailVerificationPendingResponseExample"
                MFAPendingResponse:
                  $ref: "#/components/examples/MFAPendingResponseExample"
                LoginSuccessResponse:
                  $ref: "#/components/examples/LoginSuccessResponseExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/LoginEmailVerificationPendingResponse"
                  - $ref: "#/components/schemas/MFAPendingResponse"
                  - $ref: "#/components/schemas/LoginSuccessResponse"
        "404":
          description: >
            User not found â€” no account exists with the provided email address. 
            The client should prompt the user to register before attempting login.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        "400":
          summary: Invalid credentials
          description: >
            Invalid credentials â€” the provided email or password is incorrect. 
            The client should notify the user and allow them to retry authentication.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidCredentialsError"
  /auth/email/verify:
    post:
      tags: [âœ‰ï¸ Email & Password Auth]
      summary: Authenticate a user with email and password
      description: >
        Verifies a user's email address using a verification token sent via email.
        Upon successful verification, the user's account is marked as confirmed, allowing them to complete the login process or other protected actions.
      requestBody:
        required: true
        description: Verify a user's email address
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              properties:
                code:
                  type: string
                  example: n3910310n013912310sa
      responses:
        "200":
          
          description: >
            Email verification successful. The user's email address has been confirmed, enabling them to complete the login process and access protected resources.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailConfirmedSuccessResponse"
        "400":
          
          description: >
            Verification failed due to an invalid verification code state:
            1. The code has expired â€” the user must request a new verification code.
            2. The code has already been consumed â€” the user must request a new verification code.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                VerificationCodeExpiredError:
                  $ref: "#/components/examples/VerificationCodeExpiredErrorExample"
                VerificationCodeConsumedError:
                  $ref: "#/components/examples/VerificationCodeConsumedErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/VerificationCodeExpiredError"
                  - $ref: "#/components/schemas/VerificationCodeConsumedError"
        "404":
          
          description: >
            Verification failed, the provided verification code was not found.
            This may happen if the code is invalid or never issued. The user should request a new verification code.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/VerificationCodeNotFoundError"
  /auth/password/forgot:
    post:
      tags: [âœ‰ï¸ Email & Password Auth]
      summary: Request a password reset for a user account
      description: >
        Initiates the password reset process for a user by submitting their email address. 
        If the user has two-factor authentication (MFA) enabled, an MFA verification step will be required before sending the password reset instructions. Otherwise, a password reset email will be sent directly.
      requestBody:
        required: true
        description: Email address of the user requesting a password reset
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordRequestBody"
      responses:
        "200":
          
          description: >
            Password reset request processed successfully. Depending on the user's account configuration:
            1. MFA pending â€” if the user has two-factor authentication enabled, an MFA verification step is required before sending the reset email.
            2. Reset email sent â€” if MFA is not enabled, a password reset email has been sent with instructions to reset the password.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/MFATokenCookie"
          content:
            application/json:
              examples:
                MFAPendingResponse:
                  $ref: "#/components/examples/MFAPendingResponseExample"
                ForgotPasswordSuccessResponse:
                  $ref: "#/components/examples/ForgotPasswordSuccessResponseExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/MFAPendingResponse"
                  - $ref: "#/components/schemas/ForgotPasswordSuccessResponse"
        "404":
          
          description: >
            User not found â€” no account exists for the provided email address. Ensure the email is correct and try again.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        "503":
          
          description: >
            Email service unavailable â€” the system could not send the password reset email due to a temporary email service failure. Retry the request later.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /auth/password/reset:
    patch:
      tags: [âœ‰ï¸ Email & Password Auth]
      summary: Complete the password reset process
      description: >
        Completes the password reset process for a user account using a valid verification code.  
        The request must include the verification code (typically received via email) and the new password.  
        Upon successful verification, the user's password is updated, existing authentication cookies are cleared,  
        and the user is advised to log in again. If the password reset was not initiated by the user, they are encouraged  
        to contact support immediately. The operation also records contextual information such as IP address and user agent  
        for security auditing purposes.
      requestBody:
        required: true
        description: Password reset request payload including verification code and new password
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordRequestBody"
      responses:
        "200":
          summary: Password reset successfully completed
          description: >
            Password reset completed successfully.  
            All existing authentication cookies are invalidated to ensure previous sessions are closed.  
            The user should proceed to log in with the new password.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/InvalidateAuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResetPasswordSuccessResponse"
        "404":
          summary: Verification code or user not found
          description: >
            The provided verification code or associated user could not be found.  
            This may occur if the code is invalid or the user no longer exists in the system.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                VerificationCodeNotFoundError:
                  $ref: "#/components/examples/VerificationCodeNotFoundErrorExample"
                UserNotFoundError:
                  $ref: "#/components/examples/UserNotFoundErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/VerificationCodeNotFoundError"
                  - $ref: "#/components/schemas/UserNotFoundError"
        "400":
          summary: Invalid or expired password reset request
          description: >
            The password reset request could not be completed due to invalid or expired data.  
            Possible causes include:
            - The verification code has expired or was already consumed.  
            - The new password does not meet security requirements or was previously used.  
            The client should prompt the user to request a new password reset code and try again.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                VerificationCodeExpiredError:
                  $ref: "#/components/examples/VerificationCodeExpiredErrorExample"
                VerificationCodeConsumedError:
                  $ref: "#/components/examples/VerificationCodeConsumedErrorExample"
                PasswordReuseNotAllowed:
                  $ref: "#/components/examples/PasswordReuseNotAllowedExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/VerificationCodeExpiredError"
                  - $ref: "#/components/schemas/VerificationCodeConsumedError"
                  - $ref: "#/components/schemas/PasswordReuseNotAllowed"
  /auth/refresh:
    get:
      security:
        - RefreshTokenCokie: []
      tags: [âœ‰ï¸ Email & Password Auth]
      summary: Refresh the user's access token using a valid refresh token
      description: >
        Issues a new access token (and optionally a new refresh token) for an authenticated session.  
        The request must include a valid **refresh token** stored in the user's HTTP-only cookie. If the refresh token is valid and the session is still active, a new access token will be returned and authentication cookies will be updated.  
        If the refresh token is expired, invalid, or mismatched, the session will be invalidated and all authentication cookies will be cleared to enforce re-authentication.  
        This endpoint ensures seamless session continuity while maintaining security best practices.
      responses:
        "200":
          summary: Access token successfully refreshed
          description: >
            Access token successfully refreshed.  
            The user's session remains active, and new authentication cookies are set.  
            If a new refresh token was issued, it replaces the previous one automatically.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefreshTokenEndpointSuccessResponse"
        "401":
          $ref: '#/components/responses/InvalidRefreshJwtToken'
  /auth/logout:
    post:
      security:
        - AccessTokenCokie: []
      tags: [âœ‰ï¸ Email & Password Auth]
      summary: Log out the authenticated user and invalidate the current session
      description: >
        Terminates the current authenticated session by invalidating all active authentication tokens and clearing related cookies (`accessToken`, `refreshToken`).  
        This ensures that both the access token and any linked refresh token can no longer be used.  
        The endpoint is typically called when a user explicitly logs out or when a session needs to be forcefully closed for security reasons.  
        Requires a valid access token cookie for authentication and session validation.  
        After a successful logout, the client should remove any cached session state and redirect the user to a login page.
      responses:
        "200":
          summary: Logout successful
          description: >
            User successfully logged out.  
            All authentication cookies have been invalidated and removed to ensure session termination.  
            The client should prompt the user to log in again if further access is required.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/InvalidateAuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LogoutSuccessResponse"
        "401":
          $ref: '#/components/responses/InvalidAccessJwtToken'
  /magic-link/signup:
    post:
      tags: [âœ¨ Magic-Link Authentication]
      summary: Register a new user using a magic link
      description: |
        Registers a new user account by sending a **magic link** to the provided email address. 
        The user can complete the signup process by clicking the link in the verification email. 
        If the email is already associated with an existing account, the request will be rejected.  
        This flow is typically used when passwordless authentication is enabled for the application.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MagicLinkSignUpRequestBody"
      responses:
        "200":
          summary: Magic link signup request successful
          description: |
            Signup request successful â€” a magic link has been sent to the provided email address.
            The user must click the link to verify their email and activate their account.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MagicLinkSignUpSuccessResponse"
        "401":
          summary: Unauthorized â€” email already exists
          description: |
            Unauthorized â€” the email address is already registered or cannot be used for signup.
            The client should not attempt to resend the signup link for the same email.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailAlreadyExistsError"
        "503":
          summary: Email service unavailable
          description: |
            Service Unavailable â€” the email delivery service is temporarily unavailable or failed 
            to send the verification link. The client may retry after a short delay.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /magic-link/signin:
    post:
      tags: [âœ¨ Magic-Link Authentication]
      summary: Sign in a user using a magic link
      description: |
        Initiates a passwordless sign-in flow by sending a magic link to the user email address. 
        The user can authenticate by clicking the link received in their inbox. 
        If the email is not associated with any account, the request will fail with a 404 response. 
        This endpoint is typically used in passwordless authentication systems.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MagicLinkSignInRequestBody"
      responses:
        "200":
          summary: Magic link sent successfully
          description: |
            Magic link successfully sent to the user's email address. 
            The user must click the link to complete authentication.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MagicLinkSignInSuccessResponse"
        "404":
          summary: User not found
          description: |
            Not Found. The specified email address does not match any registered user account. 
            The client should prompt the user to register or verify their email.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        "503":
          summary: Email service unavailable
          description: |
            Service Unavailable. The email delivery service is temporarily unavailable 
            or failed to send the magic link. The client may retry after a short delay.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /magic-link/resend:
    post:
      tags: [âœ¨ Magic-Link Authentication]
      summary: Resend a magic link for email verification or sign-in
      description: |
        Resends a new generated magic link to the user's email address. 
        This endpoint can be used when the user did not receive or accidentally deleted 
        the original magic link for verification or sign-in. 
        If the email does not correspond to an existing user, the request will fail with a 404 response. 
        This operation is commonly used in passwordless authentication systems to handle failed or lost verification emails.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MagicLinkSignInRequestBody"
      responses:
        "200":
          summary: Magic link resent successfully
          description: |
            Magic link successfully sent to the user's email address.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MagicLinkSignInSuccessResponse"
        "404":
          summary: User not found
          description: |
            Not Found. The specified email address does not match any registered user account. 
            The client should prompt the user to register or verify their email.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        "503":
          summary: Email service unavailable
          description: |
            Service Unavailable. The email delivery service is temporarily unavailable or failed to send the magic link. The client may retry after a short delay.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /magic-link/verify/{token}:
    get:
      tags: [âœ¨ Magic-Link Authentication]
      summary: Verify a user's email using a magic link token
      description: |
        Verifies a user's email or signs them in by validating the provided magic link token. 
        This endpoint is typically triggered when the user clicks on the magic link sent to their email. 
        Upon successful verification, authentication cookies or tokens are issued to establish the session.
      parameters:
        - name: token
          in: path
          required: true
          description: >
            A unique, single-use token included in the magic link sent to the user's email. 
            It is used to verify the user's email ownership and complete the sign-in process.
          schema:
            type: string
      responses:
        "200":
          summary: Magic link verified successfully
          description: |
            Magic link verified successfully. The user's email has been confirmed (for signup verification) 
            or the user has been signed in (for passwordless authentication). 
            Authentication cookies or tokens are issued in the response headers to establish the session.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginSuccessResponse"
        "401":
          $ref: '#/components/responses/InvalidMagicLinkJwtToken'
  /mfa/setup:
    get:
      security:
        - AccessTokenCokie: []
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Retrieve temporary TOTP secret and QR code for MFA setup
      description: |
        Initiates the setup process for Multi-Factor Authentication (MFA) using TOTP (Time-Based One-Time Password). 
        Returns a temporary secret key and a QR code that the user can scan in their authenticator app (e.g., Google Authenticator, Authy). 
        The temporary secret must be verified by the user to finalize MFA enrollment. 
        This endpoint requires the user to be authenticated via a valid access token cookie.
      responses:
        "200":
          summary: MFA verification successful
          description: >
            MFA setup initiated successfully. Returns a temporary TOTP secret and a Base64-encoded QR code image. 
            The client should display the QR code to the user for scanning in their authenticator app.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MfaSetupResponse"
        "409":
          summary: MFA already enabled for user
          description: >
            Conflict. MFA is already enabled for this user. No new temporary secret is generated. 
            The user should proceed to login with MFA or disable MFA before attempting to setup again.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MfaAlreadyEnabledError"
        "401":
          $ref: "#/components/responses/InvalidAccessJwtToken"
        "403":
          summary: User not allowed to perform MFA setup
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
  /mfa/verify:
    post:
      security:
        - AccessTokenCokie: []
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Verify the MFA code for a user
      description: >
        Verifies the multi-factor authentication (MFA) code provided by the user.
        This step is required after MFA setup or during a login flow to validate
        the one-time code generated by the authenticator app or sent via email/SMS.
        Upon successful verification, the MFA setup is confirmed or the login session is allowed.
      requestBody:
        required: true
        description: >
          Contains the one-time verification code generated by the user's authenticator app
          (e.g., Google Authenticator, Authy, Microsoft Authenticator) or received via email/SMS.
          The code must be exactly 6 digits and valid for the current authentication window.
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              properties:
                code:
                  type: string
                  description: >
                    The 6-digit one-time password (OTP) generated by the user's authenticator app
                    or received via the selected MFA method.
                  example: "482913"
      responses:
        "200":
          summary: MFA verification successful
          description: >
            The provided MFA code was valid. The user's MFA setup is confirmed
            or the login session is authenticated. No further action is required.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAVerifySetupSuccessResponse"
        "400":
          summary: Invalid MFA code or temporary secret expired
          description: >
            The MFA verification failed due to an invalid or expired code, or because the temporary secret generated during setup has expired. The user should request a new code or restart the MFA setup process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                MfaTemporarySecretExpired:
                  $ref: "#/components/examples/MfaTemporarySecretExpiredErrorExample"
                MfaInvalidverificationCode:
                  $ref: "#/components/examples/MfaInvalidVerificationCodeErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/MfaTemporarySecretExpiredError"
                  - $ref: "#/components/schemas/MfaInvalidVerificationCodeError"
        "401":
          $ref: "#/components/responses/InvalidAccessJwtToken"
        "403":
          summary: Action not allowed
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
        "409":
          summary: MFA already enabled
          description: >
            The user has already enabled MFA for their account. A new MFA setup cannot be created until the existing one is disabled.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MfaAlreadyEnabledError"
  /mfa/revoke:
    patch:
      security:
        - AccessTokenCokie: []
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Disable (revoke) Two-Factor Authentication (2FA) for the current user
      description: >
        Revokes (disables) Two-Factor Authentication (2FA) for the authenticated user.  
        The user must provide a valid MFA verification code generated by their authenticator app.  
        Once verified, the user's 2FA secret and backup codes will be permanently removed.
      requestBody:
        required: true
        description: >
          Contains the one-time MFA code generated by the user's authenticator app.  
          This code is used to verify ownership of the 2FA secret before disabling it.
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              content:
                application/json:
                  schema:
                    type: object
                    required:
                      - code
                    properties:
                      code:
                        type: string
                        description: >
                          The 6-digit one-time password (OTP) generated by the user's authenticator app.  
                          Must be valid at the time of request.
                        example: "481293"
      responses:
        '200':
          summary: MFA disabled successfully
          description: >
            Two-Factor Authentication (2FA) has been successfully disabled for the authenticated user.  
            The user's account no longer requires MFA verification during login.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MFARevokeSuccessReponse'
        '400':
          summary: Invalid code
          description: >
            Bad Request â€” The provided MFA verification code is invalid or expired.  
            The client should request a new code from the authenticator app and try again.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MfaInvalidVerificationCodeError'
        "401":
          $ref: "#/components/responses/InvalidAccessJwtToken"
        "403":
          summary: Action not allowed
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
        '404':
          summary: User not found
          description: >
            Not Found â€” The authenticated user does not exist in the system or could not be retrieved.  
            This may indicate that the user was deleted or the JWT token references an invalid account.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserNotFoundError'
        '409':
          summary: MFA already disabled
          description: >
            Conflict â€” Two-Factor Authentication is already disabled for this account.  
            No further action is required.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MfaAlreadyDisabledError'
  /mfa/backup-code/consume:
    post:
      security:
        - AccessTokenCokie: []
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Disable Two-Factor Authentication (2FA) using a backup code
      description: >
        Disables Multi-Factor Authentication (2FA) for the currently authenticated user using one of their previously generated backup codes.  
        This endpoint can be used when the user no longer has access to their authenticator app but still possesses a valid backup code.  
        Upon successful verification of the provided backup code, all remaining backup codes are invalidated, the MFA secret is removed, and 2FA is fully disabled for the account.
      requestBody:
        required: true
        description: >
          A JSON object containing the backup code the user wishes to use for disabling MFA.  
          The code must be one of the valid, unused backup codes generated when MFA was enabled.
        content:
          application/json:
            schema:
              type: object
              required: 
                - backupCode
              properties: 
                backupCode:
                  type: string  
                  description: The valid unused backup code associated with the user's account.
                  example: "3F9A2B7QK"
      responses:
        responses:
        '200':
          summary: MFA disabled successfully
          description: >
            Two-factor authentication has been successfully disabled for the user's account.  
            All existing backup codes and the MFA secret have been removed.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MFARevokeSuccessReponse'
        '400':
          summary: Invalid or expired backup code
          description: >
            The provided backup code is invalid, has already been used, or does not match any active codes associated with the user's account.  
            The user should try a different valid backup code.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvalidBackupCodeError'
        "401":
          $ref: "#/components/responses/InvalidAccessJwtToken"
        "403":
          summary: Action not allowed
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
        '404':
          summary: User not found
          description: >
            Not Found â€” The authenticated user does not exist in the system or could not be retrieved.  
            This may indicate that the user was deleted or the JWT token references an invalid account.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserNotFoundError'
        '409':
          summary: MFA already disabled
          description: >
            Conflict â€” Two-Factor Authentication is already disabled for this account.  
            No further action is required.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MfaAlreadyDisabledError'
  /mfa/backup-code/login:
    post:
      security:
        - MfaTokenCokie: []
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Log in using a backup code
      description: >
        Authenticates a user by consuming one of their valid MFA backup codes.
        This endpoint is typically used when a user cannot access their authenticator app but has saved backup codes.  
        Upon successful verification, a new authenticated session is created, access and refresh tokens are issued, and the used backup code is invalidated (removed from the account).  
        The `mfaToken` cookie used during the MFA flow is cleared upon successful login.
      requestBody:
        required: true
        description: >
          The valid unused backup code associated with the user's account.
          The backup code must match one of the stored valid codes and will be invalidated once used.
        content:
          application/json:
            schema:
              type: object
              required: 
                - backupCode
              properties: 
                backupCode:
                  type: string  
                  description: The valid unused backup code associated with the user's account.
                  example: "3F9A2B7QK"
      responses:
        "200":
          summary: MFA backup code login successful
          description: >
            The user has been successfully authenticated using a valid backup code.  
            A new session is created, and both access and refresh tokens are returned and set as cookies.  
            The used backup code is invalidated and removed from the user's account.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginSuccessResponse"
        '400':
          summary: Invalid or expired backup code
          description: >
            The provided backup code is invalid, has already been used, or does not match any active codes associated with the user's account.  
            The user should try a different valid backup code.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvalidBackupCodeError'
        "401":
          $ref: "#/components/responses/InvalidMFAJwtToken"
        "403":
          summary: Action not allowed
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
        '404':
          summary: User not found
          description: >
            Not Found â€” The authenticated user does not exist in the system or could not be retrieved.  
            This may indicate that the user was deleted or the JWT token references an invalid account.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserNotFoundError'
  /mfa/verify/login:
    post: 
      security:
        - MfaTokenCokie: []
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Verify MFA code during login
      description: >
        Validates the one-time MFA code provided by the user during the login process.  
        This endpoint finalizes the multi-factor authentication (MFA) login flow by verifying the 6-digit time-based one-time password (TOTP) generated by the userâ€™s authenticator app.  
        Upon successful verification, a new authenticated session is created, and both access and refresh tokens are issued. The temporary `mfaToken` cookie is cleared once login is complete.
      requestBody:
        required: true
        description: >
          Contains the one-time MFA code generated by the user's authenticator app.  
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              content:
                application/json:
                  schema:
                    type: object
                    required:
                      - code
                    properties:
                      code:
                        type: string
                        description: >
                          The 6-digit one-time password (OTP) generated by the user's authenticator app.  
                          Must be valid at the time of request.
                        example: "481293"
      responses:
        "200":
          summary: MFA verification successful
          description: >
            The provided MFA code has been successfully verified.  
            A new user session is created, and both access and refresh tokens are set as cookies.  
            The user is now fully authenticated, and the temporary MFA token is cleared.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginSuccessResponse"
        '400':
          summary: Invalid MFA code or MFA not enabled
          description: >
            The provided MFA code is invalid, expired, or the user does not have MFA enabled.  
            This can occur if:
              - The MFA setup has not been completed for this account.
              - The user entered an incorrect or outdated code.
            The client should prompt the user to try again or restart the MFA setup process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                MfaNotEnabled:
                  $ref: "#/components/examples/MfaNotEnabledErrorExample"
                MfaInvalidVerificationCode:
                  $ref: "#/components/examples/MfaInvalidVerificationCodeErrorExample"
              schema:
                oneOf:
                  - $ref: '#/components/schemas/MfaNotEnabledError'
                  - $ref: '#/components/schemas/MfaInvalidVerificationCodeError'
        "401":
          $ref: "#/components/responses/InvalidMFAJwtToken"
        "403":
          summary: Action not allowed
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
        '404':
          summary: User not found
          description: >
            Not Found â€” The authenticated user does not exist in the system or could not be retrieved.  
            This may indicate that the user was deleted or the JWT token references an invalid account.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserNotFoundError'
  /mfa/verify/forgot-password:
    post:
      post: 
      security:
        - MfaTokenCokie: []
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Verify MFA code for password reset
      description: >
        Verifies the one-time MFA code submitted by the user in order to proceed with a password reset.  
        Upon successful verification, a password reset email is sent to the user's registered email address with a link to complete the password change process.  
        This endpoint also clears the temporary MFA token cookie to prevent reuse.
      requestBody:
        required: true
        description: >
          Contains the one-time MFA code generated by the user's authenticator app.  
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              content:
                application/json:
                  schema:
                    type: object
                    required:
                      - code
                    properties:
                      code:
                        type: string
                        description: >
                          The 6-digit one-time password (OTP) generated by the user's authenticator app.  
                          Must be valid at the time of request.
                        example: "481293"
      responses:
        '200':
          summary: MFA code verified successfully
          description: >
            The provided MFA code was valid. A password reset email has been sent to the user's registered email address, and the user should follow the link to complete the password change.  
            The temporary MFA token cookie has been cleared to prevent reuse.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MFARequestChangePasswordSuccessReponse'
        '400':
          summary: Invalid MFA code or MFA not enabled
          description: >
            The provided MFA code is invalid, expired, or the user does not have MFA enabled.  
            This can occur if:
              - The MFA setup has not been completed for this account.
              - The user entered an incorrect or outdated code.
            The client should prompt the user to try again or restart the MFA setup process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                MfaNotEnabled:
                  $ref: "#/components/examples/MfaNotEnabledErrorExample"
                MfaInvalidVerificationCode:
                  $ref: "#/components/examples/MfaInvalidVerificationCodeErrorExample"
              schema:
                oneOf:
                  - $ref: '#/components/schemas/MfaNotEnabledError'
                  - $ref: '#/components/schemas/MfaInvalidVerificationCodeError'
        "401":
          $ref: "#/components/responses/InvalidMFAJwtToken"
        "403":
          summary: Action not allowed
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
        '404':
          summary: User not found
          description: >
            Not Found â€” The authenticated user does not exist in the system or could not be retrieved.  
            This may indicate that the user was deleted or the JWT token references an invalid account.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserNotFoundError'
        "503":
          summary: Email service unavailable
          description: >
            The password reset email could not be sent because the email delivery service is temporarily unavailable or failed.  
            The client may retry the request after a short delay.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /passkey/register/init:
    post:
      tags: [ðŸŽ­ Passkey Authentication]
      summary: Initialize a passkey registration session
      description: >
        Starts the registration process for a new user using passwordless passkey authentication. 
        The client provides the user's name and email address. If the email is not already registered, the server generates a **PublicKeyCredentialCreationOptions** object required by the WebAuthn API.
        This object includes a challenge, relying party information, user details, allowed algorithms, and authenticator selection criteria. It must be sent back to the client to complete the registration on the authenticator (device or platform). The server also stores a temporary PasskeyChallengeSession to track the challenge for later verification.
      requestBody: 
        required: true
        description: >
          Contains the user's registration information:
          - **name**: Full name or display name of the user.
          - **email**: User's email address for account identification.
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - email
              properties:
                name:
                  type: string
                  description: The display name of the user registering a passkey.
                  example: "John Doe"
                email:
                  type: string
                  description: The email address of the user registering a passkey.
                  example: "john.doe@gmail.com"
      responses:
        '201':
          summary: Passkey registration session created
          description: >
            The server successfully generated a **PublicKeyCredentialCreationOptions** object for passkey registration.
            This object contains all necessary information for the client to complete registration on the user's device.
            The response also includes a unique request ID for tracing.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyGenerateSignUpSessionSuccessResponse'
        '404':  
          summary: Email already registered
          description: >
            Registration failed because the provided email address is already associated with an existing account.
            The client should prompt the user to log in or use a different email for registration.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailAlreadyExistsError'
  /passkey/register/verify:
    post:
      tags: [ðŸŽ­ Passkey Authentication]
      summary: Verify a passkey registration session and complete user signup
      description: |
        Verifies a passkey registration session provided by the client to complete the user signup process.
        The client must provide a `PasskeyRegistrationResponse` object containing the credential information generated during the passkey registration initiation.
      requestBody:
        required: true
        description: |
          Contains the client-generated passkey registration response used to verify and complete the user signup.
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasskeyCompletRegistrationRequestBody'
      responses:
        '200':
          summary: Passkey registration verified and user created successfully
          description: |
            The passkey registration was successfully verified. 
            A new user account has been created and a verification email has been sent to the provided email address.
            The response contains:
              - `user`: Newly created user data
              - `isVerificationEmailSend`: Boolean flag indicating whether the verification email was sent
              - `nextStep`: Indicates the next step for the client in the signup flow
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegistrationSuccessReponse'
        '401':
          summary: Passkey verification failed or session expired
          description: |
            The authentication failed due to one of the following reasons:
              - Passkey registration session not found
              - Passkey session expired
              - Passkey verification could not be completed successfully
            The client should restart the passkey registration process in case of failure.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                PasskeyChallengeSessionExpired:
                  $ref: '#/components/examples/PasskeyChallengeSessionExpiredErrorExample'
                PasskeyChallengeSessionNotFound:
                  $ref: '#/components/examples/PasskeyChallengeSessionNotFoundErrorExample'
                PasskeyChallengeVerification:
                  $ref: '#/components/examples/PasskeyChallengeVerificationErrorExample'
              schema:
                oneOf:
                  - $ref: '#/components/schemas/PasskeyChallengeSessionNotFoundError'
                  - $ref: '#/components/schemas/PasskeyChallengeSessionExpiredError'
                  - $ref: '#/components/schemas/PasskeyChallengeVerificationError'
        '400':
          summary: Invalid passkey session purpose
          description: |
            The passkey registration session exists but the purpose does not match "signup". 
            This can occur if a session intended for a different operation is reused.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyChallengeSessionInvalidPurposeError'
        '409':
          summary: Passkey session already consumed
          description: |
            The passkey registration session has already been used for verification. 
            This ensures that a registration session cannot be reused ( prevent replay attacks).
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyChallengeSessionConsumedError'
  /passkey/authenticate/init:
    post:
      tags: [ðŸŽ­ Passkey Authentication]
      summary: Initialize a passkey authentication (sign-in) session
      description: >
        Initializes a new **WebAuthn passkey authentication session** for a user who wants to sign in using a registered passkey.  
        The endpoint generates a new WebAuthn **authentication challenge** and returns a set of `PublicKeyCredentialRequestOptions` that the frontend must pass to the browser's WebAuthn API (`navigator.credentials.get`).  
        
        The generated challenge is stored securely in the backend and will later be verified during the `/passkey/authenticate/verify` step.  
        No user identifier is required at this stage, as the passkey authenticator handles user identification during the authentication process.
        
        This endpoint should be called from the frontend **before** invoking the browser WebAuthn API.
        
        ---
        **Typical flow:**
        1. Frontend calls `POST /passkey/authenticate/init`
        2. Backend generates and stores challenge + session
        3. Frontend receives `publicKeyCredentialRequestOptions`
        4. Frontend calls `navigator.credentials.get(options)` with those options
        5. The result is sent to `/passkey/authenticate/verify` for final verification
      responses:
        '201':
          summary: Passkey sign-in session successfully created
          description: >
            The passkey sign-in session has been created successfully.  
            The response contains the `PublicKeyCredentialRequestOptions` object required by the browserâ€™s WebAuthn API to initiate user authentication.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyGenerateSignInSessionSuccessResponse'
  /passkey/authenticate/verify:
    post:
      tags: [ðŸŽ­ Passkey Authentication]
      summary: Verify a passkey authentication response and complete user login
      description: |
        Completes the **passkey-based sign-in process** by verifying the WebAuthn authentication response 
        returned by the browser after calling `navigator.credentials.get()`.  
        
        This endpoint:
          - Validates the cryptographic response (challenge, signature, authenticator data)
          - Ensures the passkey session is still valid and not consumed
          - Confirms that the user exists and is eligible for login
          - Creates a new authenticated session and issues secure access and refresh tokens

        On success, the user is authenticated, tokens are issued, and authentication cookies are set.  
        If the user's email has not yet been verified, the endpoint returns a pending verification response instead of logging in.
      requestBody:
        description: |
          WebAuthn **authentication response** returned by the browserâ€™s 
          `navigator.credentials.get()` call.  
          It includes the credential ID, authenticator data, and digital signature required for verification.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasskeyCompletAuthenticationRequestBody'
      responses:
        '200':
          description: |
            The passkey authentication response has been verified and the user successfully logged in.  
            Depending on the user's verification status, one of the following responses is returned:

            - **LoginSuccessResponse:** user authenticated and session created  
            - **LoginEmailVerificationPendingResponse:** user must first verify their email before continuing
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              examples:
                LoginEmailVerificationPendingResponse:
                  $ref: "#/components/examples/LoginEmailVerificationPendingResponseExample"
                LoginSuccessResponse:
                  $ref: "#/components/examples/LoginSuccessResponseExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/LoginEmailVerificationPendingResponse"
                  - $ref: "#/components/schemas/LoginSuccessResponse"
        "404":
          description: >
            User not found â€” no account exists with the provided email address. 
            The client should prompt the user to register before attempting login.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        '401':
          description: |
            The authentication failed due to one of the following reasons:
              - Passkey registration session not found
              - Passkey session expired
              - Passkey verification could not be completed successfully
            The client should restart the passkey registration process in case of failure.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                PasskeyChallengeSessionExpired:
                  $ref: '#/components/examples/PasskeyChallengeSessionExpiredErrorExample'
                PasskeyChallengeSessionNotFound:
                  $ref: '#/components/examples/PasskeyChallengeSessionNotFoundErrorExample'
                PasskeyChallengeVerification:
                  $ref: '#/components/examples/PasskeyChallengeVerificationErrorExample'
                PasskeyNotFound:
                  $ref: '#/components/examples/PasskeyNotFoundErrorExample'
              schema:
                oneOf:
                  - $ref: '#/components/schemas/PasskeyChallengeSessionNotFoundError'
                  - $ref: '#/components/schemas/PasskeyChallengeSessionExpiredError'
                  - $ref: '#/components/schemas/PasskeyChallengeVerificationError'
                  - $ref: '#/components/schemas/PasskeyNotFoundError'
        '400':
          summary: Invalid passkey session purpose
          description: |
            The passkey registration session exists but the purpose does not match "signup". 
            This can occur if a session intended for a different operation is reused.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyChallengeSessionInvalidPurposeError'
        '409':
          summary: Passkey session already consumed
          description: |
            The passkey registration session has already been used for verification. 
            This ensures that a registration session cannot be reused ( prevent replay attacks).
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyChallengeSessionConsumedError'
  /passkey/add-passkey/init/{userid}:
    post:
      security:
        - AccessTokenCokie: []
      tags: [ðŸŽ­ Passkey Management]
      summary: Initialize a new passkey registration session for an authenticated user
      description: |
        Initializes a **WebAuthn passkey registration session** that allows a logged-in user to securely add a new passkey to their account.  

        This endpoint performs the following steps:
          1. Validates the authenticated user and checks that they match the `{userid}` path parameter.
          2. Retrieves existing passkeys associated with the account to prevent re-registration of the same authenticator.
          3. Generates a new **WebAuthn PublicKeyCredentialCreationOptions** object (challenge, relying party info, user identity, supported algorithms, etc.).
          4. Persists the challenge session in the database with the `"add-new-key"` purpose for later verification.

        The client (frontend) should use the returned `publicKeyOpts` object as input for the `navigator.credentials.create()` call in the browser.

        This route requires a valid **access token cookie** for authentication.
      parameters:
      - name: userid
        in: path
        required: true
        description: The unique identifier of the user who is adding a new passkey. Must match the currently authenticated user.
        schema:
          type: string
          example: "64f2d2ab8e2e1b03b6f3cd44"
      responses:
        '201':
          description: |
            Returns the WebAuthn registration challenge and configuration parameters required for the browser to begin passkey registration.
            The frontend should use this response to call `navigator.credentials.create()` and generate a new credential.
          content:  
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyGenerateSignUpSessionSuccessResponse'
        '401':
          $ref: '#/components/responses/InvalidAccessJwtToken'
        '403':
          description: |
            Returned when the `{userid}` path parameter does not match the authenticated user.
            This ensures that users cannot create passkeys for other accounts.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenError'
  /passkey/add-passkey/verify/{userid}:
    post:
      security:
        - AccessTokenCokie: []
      tags: [ðŸŽ­ Passkey Management]
      summary: Verify and finalize new Passkey registration
      description: |
        Completes the registration of a new **Passkey** for the currently authenticated user.  
        This endpoint verifies the passkey attestation response generated by the client after initiating the "Add new passkey" process.  
        
        Once verification succeeds:
          - The passkey is securely registered and linked to the userâ€™s account.
          - The corresponding challenge session is marked as consumed.
          - A success response containing the stored passkey details is returned.
        
        Access to this endpoint requires a valid authenticated session and a matching user ID in the path parameter.
      parameters:
      - name: userid
        in: path
        required: true
        description: The unique identifier of the user who is adding a new passkey. Must match the currently authenticated user.
        schema:
          type: string
          example: "64f2d2ab8e2e1b03b6f3cd44"
      requestBody:
        required: true
        description: |
          Contains the **passkey attestation response** returned by the browser after a successful WebAuthn registration ceremony.  
          This data is verified server-side to ensure that the credential is valid, was generated for the expected challenge, and belongs to the authenticated user.
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasskeyCompletRegistrationRequestBody'
      responses:
        '201':
          summary: Passkey successfully verified and added
          description: >
            The provided passkey attestation response was successfully verified,  
            and a new passkey credential has been securely added to the user's account.  
            The challenge session has been marked as consumed to prevent replay attacks.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyAddedSuccessResponse'
        '401':
          summary: Passkey verification failed or session expired
          description: |
            The verification of the passkey failed due to one of the following reasons:
              - The registration session was not found or has expired.
              - The provided credential is invalid or does not match the expected challenge.
              - The user's authentication token is missing or invalid.
            
            The client should prompt the user to restart the passkey registration process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                PasskeyChallengeSessionExpired:
                  $ref: '#/components/examples/PasskeyChallengeSessionExpiredErrorExample'
                PasskeyChallengeSessionNotFound:
                  $ref: '#/components/examples/PasskeyChallengeSessionNotFoundErrorExample'
                PasskeyChallengeVerification:
                  $ref: '#/components/examples/PasskeyChallengeVerificationErrorExample'
                PasskeyNotFound:
                  $ref: '#/components/examples/PasskeyNotFoundErrorExample'
                AuthenticationTokenNotFound:
                  $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
                AccessTokenType:
                  $ref: "#/components/examples/AccessTokenTypeErrorExample"
                AuthenticationTokenUserNotFound:
                  $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
                AuthenticationTokenInvalidSession:
                  $ref: "#/components/examples/AuthenticationTokenInvalidSessionErrorExample"
                AuthenticationTokenSessionMismatch:
                  $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
                AuthenticationTokenInvalidToken:
                  $ref: "#/components/examples/AuthenticationTokenInvalidErrorExample"
                AuthenticationTokenExpired:
                  $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
              schema:
                oneOf:
                  - $ref: '#/components/schemas/PasskeyChallengeSessionNotFoundError'
                  - $ref: '#/components/schemas/PasskeyChallengeSessionExpiredError'
                  - $ref: '#/components/schemas/PasskeyChallengeVerificationError'
                  - $ref: '#/components/schemas/PasskeyNotFoundError'
                  - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
                  - $ref: "#/components/schemas/AccessTokenTypeError"
                  - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidSessionError"
                  - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
                  - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
        '400':
          summary: Invalid passkey session purpose
          description: >
            The provided challenge session exists, but its purpose does not match `"add-new-key"`.  
            This can occur if a session intended for another purpose (e.g., login or signup) is reused.
          headers:
              X-Request-Id:
                $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyChallengeSessionInvalidPurposeError'
        '409':
          summary: Passkey session already consumed
          description: >
            The passkey registration session has already been used.  
            This safeguard prevents replay attacks by ensuring a challenge session cannot be reused.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyChallengeSessionConsumedError'
        "403":
          summary: Forbidden â€“ user mismatch
          description: >
            The authenticated user does not match the user ID provided in the path parameter.  
            Users are only allowed to add passkeys to their own accounts.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenError'
  /passkey/remove-key/init/{userid}/{credentialid}:
    post: 
      security:
        - AccessTokenCokie: []
      tags: [ðŸŽ­ Passkey Management]
      summary: Initiate Passkey removal for a user
      description: |
        This endpoint initiates the process to remove a passkey associated with a user's account.  
        The user must be authenticated and authorized to remove a specific passkey, identified by the `credentialid`.  
        Upon successful initiation, a passkey removal session is created, and options for the passkey removal request (such as challenge data) are returned.  
        The challenge session is created to ensure that the request is authentic, and no unauthorized changes can be made to the passkey list.
        
        **Important:** 
        - The user must be authenticated using a valid access token (passed via cookies).
        - The `userid` and `credentialid` parameters must match the currently authenticated user and the passkey being removed.
      parameters:
      - name: userid
        in: path
        required: true
        description: >
          The unique identifier of the user who is removing a passkey.  
          This must match the authenticated user's ID. Only the user who owns the passkey can initiate the removal.
        schema:
          type: string
          example: "64f2d2ab8e2e1b03b6f3cd44"

      - name: credentialid
        in: path
        required: true
        description: >
          The unique identifier of the passkey credential that is being removed.  
          This should match the credential ID of the passkey to be deleted.
        schema:
          type: string
          example: "a1b2c3d4e5f6789ghijk01234lm56789"
      responses:
        '201':
          summary: Passkey removal session initiated successfully
          description: >
            The passkey removal session has been successfully created, and challenge options for removing the passkey are returned.  
            The user must complete the challenge to finalize the removal process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyGenerateRemoveKeySuccessResponse'
        "403":
          summary: Forbidden â€“ user mismatch
          description: >
            The authenticated user does not match the user ID provided in the path parameter.  
            Users are only allowed to add passkeys to their own accounts.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenError'
        "404":
          summary: Passkey not found
          description: >
            The passkey specified by the `credentialid` was not found in the system.  
            This error occurs when the provided credential ID does not exist or is invalid.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyNotFoundError'
        "401":
          $ref: '#/components/responses/InvalidAccessJwtToken'
  /passkey/remove-key/verify/{userid}/{credentialid}:
    delete:
      security:
        - AccessTokenCokie: []
      tags: [ðŸŽ­ Passkey Management]
      summary: Remove a passkey credential from a user's account
      description: >
        This endpoint allows the authenticated user to remove a specific passkey credential from their account.
        The request must include the user ID and the credential ID of the passkey to be removed.
        The user can only remove their own passkeys. This action requires authentication and the provided session must be valid. If successful, the passkey will be permanently deleted from the system, and the session used for verification will be marked as consumed.
      parameters:
      - name: userid
        in: path
        required: true
        description: >
          The unique identifier of the user who is removing a passkey.  
          This must match the authenticated user's ID. Only the user who owns the passkey can initiate the removal.
        schema:
          type: string
          example: "64f2d2ab8e2e1b03b6f3cd44"

      - name: credentialid
        in: path
        required: true
        description: >
          The unique identifier of the passkey credential that is being removed.  
          This should match the credential ID of the passkey to be deleted.
        schema:
          type: string
          example: "a1b2c3d4e5f6789ghijk01234lm56789"
      requestBody:
        description: >
          The authentication response containing the necessary data for validating the passkey removal.
          This includes the signature and other relevant data to ensure the security of the operation.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasskeyCompletAuthenticationRequestBody'
      responses:
        '204':
          summary: Successfully removed the passkey
          description: >
            The passkey credential was successfully removed from the user's account.
            The associated session for verification has been marked as consumed.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyRemovedSuccessResponse'
        '400':
          summary: Invalid passkey session
          description: >
            The passkey session is invalid, possibly due to incorrect purpose or expired session. 
            Please initiate the process again.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyChallengeSessionInvalidPurposeError'
        '403':
          summary: Forbidden â€“ user mismatch
          description: >
            The authenticated user does not match the user ID provided in the path parameter.  
            Users are only allowed to remove passkeys from their own accounts.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenError'
        '404':
          summary: Passkey not found
          description: >
            The specified passkey credential could not be found or is no longer associated with the user.
            Please check the provided credential ID.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyNotFoundError'
        '401':
          summary: Unauthorized â€“ Invalid or Expired Authentication Token or Passkey Challenge
          description: >
            The provided authentication token is either invalid, expired, or missing, or there is an issue with the passkey authentication challenge. This may occur for several reasons:
            - **Invalid Token**: The authentication token provided does not match any active session, or the user ID does not match the token's user.
            - **Expired Token**: The authentication token has surpassed its expiration time, meaning the session is no longer valid.
            - **Token Not Found**: The authentication token was not included in the request, or it cannot be found in the system.
            - **Session Mismatch**: The token provided does not correspond to the current session, or it was issued for a different session or client.
            - **Passkey Challenge Session Not Found**: The passkey challenge session associated with the user was not found, or it may have been invalidated.
            - **Passkey Challenge Session Expired**: The passkey challenge session has expired, meaning it is no longer valid for completing the authentication.
            - **Passkey Verification Error**: The passkey verification failed, either due to incorrect credentials, an expired challenge, or a mismatch in the expected data (such as the challenge itself, or the origin/ID).
            
            If you encounter this error, the following checks may help:
            - Ensure that the authentication token is valid and has not expired or been revoked.
            - Make sure the token corresponds to the correct user session.
            - Verify that you are submitting the correct passkey challenge response and that the session has not expired.
            - If the challenge session is expired or consumed, initiate a new passkey registration process.

            Additionally:
            - Ensure that the passkey verification step is completed properly, including correct matching of the public key, credentials, and session data.
            - If you are using a client or browser, confirm that the token and passkey response are correctly passed in the request.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                PasskeyChallengeSessionNotFound:
                  $ref: '#/components/examples/PasskeyChallengeSessionNotFoundErrorExample'
                PasskeyChallengeSessionExpired:
                  $ref: '#/components/examples/PasskeyChallengeSessionExpiredErrorExample'
                PasskeyChallengeVerification:
                  $ref: '#/components/examples/PasskeyChallengeVerificationErrorExample'
                AuthenticationTokenNotFound:
                  $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
                AccessTokenType:
                  $ref: "#/components/examples/AccessTokenTypeErrorExample"
                AuthenticationTokenUserNotFound:
                  $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
                AuthenticationTokenInvalidSession:
                  $ref: "#/components/examples/AuthenticationTokenInvalidSessionErrorExample"
                AuthenticationTokenSessionMismatch:
                  $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
                AuthenticationTokenInvalidToken:
                  $ref: "#/components/examples/AuthenticationTokenInvalidErrorExample"
                AuthenticationTokenExpired:
                  $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
              schema:
                oneOf:
                  - $ref: '#/components/schemas/PasskeyChallengeSessionNotFoundError'
                  - $ref: '#/components/schemas/PasskeyChallengeSessionExpiredError'
                  - $ref: '#/components/schemas/PasskeyChallengeVerificationError'
                  - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
                  - $ref: "#/components/schemas/AccessTokenTypeError"
                  - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidSessionError"
                  - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
                  - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
        '409':
          summary: Passkey challenge session already consumed
          description: >
            The passkey challenge session has already been used to remove a passkey. Please restart the process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyChallengeSessionConsumedError'
  /passkey/all/{userid}:
    get:
      security:
        - AccessTokenCokie: []
      tags: [ðŸŽ­ Passkey Management]
      summary: Retrieve all passkeys associated with a user.
      description: >
        This endpoint allows you to retrieve all passkeys that are associated with a specific user by their unique `userid`. 
        The user must be authenticated and the `userid` in the path must match the authenticated user's ID to prevent unauthorized access.
        Each passkey returned will include essential details such as the credential ID, the associated provider (`aaguid`), the date it was created, 
        and the last time it was used. The response also includes metadata with the total count of passkeys retrieved.
      parameters:
      - name: userId
        in: path
        required: true
        description: The unique identifier of the user for whom the sessions are being retrieved.
        schema:
          type: string
          example: "60c72b2f9f1b2c001c8a3e5f"
      responses:
        '200':
          description: >
            The passkeys for the authenticated user have been successfully retrieved. The response includes the details of each passkey,
            such as the credential ID, the associated provider (`aaguid`), and the creation date. The metadata includes the total count 
            of passkeys returned.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasskeyGetAllPasskeyByUserIdSuccessResponse'
        '401':
          $ref: '#/components/responses/InvalidAccessJwtToken'
        '403':
          description: >
            The `userid` parameter does not match the authenticated user. Only the authenticated user can retrieve their own passkeys.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json: 
              schema: 
                $ref: '#/components/schemas/ForbiddenError'
  /session/all:
    get:
      security:
        - AccessTokenCokie: []
      tags: [ðŸ”’ Session Management]
      summary: Retrieve all active sessions for the authenticated user
      description: >
        Retrieves a list of all **active login sessions** associated with the authenticated user.  
        This endpoint allows a user to view all currently valid sessions across devices and browsers, helping with account activity monitoring and session management.  
        
        Each returned session includes device information (`userAgent`), creation and expiration timestamps, and a boolean flag (`isCurrent`) indicating whether it corresponds to the current active session (the one used to make the request).  
        
        Expired sessions are automatically filtered out and are **not included** in the response.
      responses:
        '200':
          summary: Active sessions retrieved successfully
          description: >
            The request was successful and returned a list of the user's active sessions.  
            Each session entry contains user agent details (browser, OS, platform), creation and expiration dates, and a flag marking the current session.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetAllSessionsSuccessResponse'
        '401':
          $ref: '#/components/responses/InvalidAccessJwtToken'
  /session/:
      get:
        tags: [ðŸ”’ Session Management]
        security:
          - AccessTokenCokie: []
        summary: Retrieve the current user session
        description: >
          Retrieves the **current active session** for the authenticated user, based on the session ID stored in the request context.  
          This endpoint is primarily used to identify the session associated with the current request and to retrieve minimal user information .
        responses:
          '200':
            summary: Current user session retrieved successfully
            description: >
              The session corresponding to the current request has been found.  
              Returns the user associated with this session along with metadata about the request.
            headers:
              X-Request-Id:
                $ref: "#/components/headers/XRequestId"
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetCurrentSessionSuccessResponse'
          '401':
            $ref: '#/components/responses/InvalidAccessJwtToken'
  /session/{id}:
    delete:
      tags: [ðŸ”’ Session Management]
      security:
        - AccessTokenCokie: []
      summary: Delete a user session by ID
      description: >
        Deletes a specific user session identified by its ID. 
        The operation validates that the session exists and that the authenticated user has permission to delete it. 
        If the deleted session is the current session of the user, authentication cookies will be cleared, effectively logging the user out.
        
        Responses include a success message and, if the current session was deleted, a `nextStep` indicating that the user should be redirected to the login page.
        
        Possible errors:
          - 403 Forbidden: If the user tries to delete a session that does not belong to them.
          - 404 Not Found: If the session ID does not exist.
      parameters:
      - name: id
        in: path
        required: true
        description: The unique identifier of the session who will be deleted.
        schema:
          type: string
          example: "60c72b2f9f1b2c001c8a3e5f"
      responses:
        '200':
          summary: User session successfully deleted
          description: >
            The session with the specified ID was successfully deleted. 
            If the deleted session was the current session of the authenticated user, authentication cookies are cleared,
            effectively logging the user out. The response includes a `nextStep` field indicating whether the client
            should redirect the user to the login page.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: '#/components/headers/InvalidateAuthenticationCookies'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteSessionByIdSuccessResponse'
        '401':
          $ref: '#/components/responses/InvalidAccessJwtToken'
        '403':  
          summary: Forbidden - user cannot delete this session
          description: >
            The authenticated user attempted to delete a session that does not belong to them.
            The operation is denied to prevent unauthorized access to other users' sessions.
            Ensure that the session ID belongs to the current user before attempting deletion.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenError'
  /oidc/google/auth-url:
    get:
      tags: [ðŸ¤ OIDC Authentication]
      summary: Generate Google OIDC authorization URL
      description: >
        Initiates the OAuth 2.0 Authorization Code Flow with PKCE for Google sign-in.
        This endpoint generates a unique `state` and `code_challenge`, stores them in the database as an OIDC session, and redirects the client to the Google OAuth 2.0 authorization endpoint.
        
        The `state` is used to prevent CSRF attacks, and `code_challenge` is part of PKCE to enhance security.

        **Behavior:**
        - Returns an HTTP 307 redirect to the Google authorization URL.
        - Sets caching headers to prevent storing sensitive information.
        - No JSON body is returned.

        **Authorization URL parameters sent to Google:**
        - `access_type`: Requests offline access to receive refresh tokens (`offline`)
        - `response_type`: Expected response type (`code`)
        - `client_id`: Google OAuth Client ID
        - `scope`: Requested access scopes (`openid profile email`)
        - `redirect_uri`: Callback URL registered in Google OAuth App
        - `state`: Randomly generated string to prevent CSRF
        - `code_challenge` and `code_challenge_method`: PKCE parameters (`S256`)
        
      responses:
        '307':
          description: Redirects the client to Google OAuth 2.0 authorization URL
          headers:
            Location:
              description: The Google authorization URL
              schema:
                type: string
                example: https://accounts.google.com/o/oauth2/v2/auth?access_type=offline&response_type=code&client_id=YOUR_CLIENT_ID&scope=openid%20profile%20email&redirect_uri=https%3A%2F%2Fyourapp.com%2Fauth%2Fgoogle%2Fcallback&state=RANDOM_STATE&code_challenge=RANDOM_CODE_CHALLENGE&code_challenge_method=S256
          content: {}
        '500':
          description: Server error occurred while generating authorization URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerError'
  /oidc/google/callback:
      get:
        tags: [ðŸ¤ OIDC Authentication]
      summary: Authenticate user via Google OIDC callback
      description: >
        Handles the callback from Google after user authorization.
        Expects `code` and `state` query parameters returned by Google. 
        
        **Flow:**
        1. Verify that the `state` exists, has not expired, and has not been consumed.
        2. Exchange the authorization code for tokens (access token, refresh token, ID token).
        3. Validate the ID token against Google's JWKS endpoint and verify claims.
        4. Create or find a corresponding user in the local database.
        5. Set authentication cookies (`accessToken` and `refreshToken`).
        6. Return a JSON response indicating successful login.

      parameters:
        - name: code
          in: query
          required: true
          description: Authorization code returned by Google
          schema:
            type: string
        - name: state
          in: query
          required: true
          description: Unique state generated during the authorization request
          schema:
            type: string

      responses:
        '200':
          summary: Authentication successful via Google OIDC
          description: >
            The user has been successfully authenticated using Google as an OpenID Connect (OIDC) provider. 
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginSuccessResponse'
        '404':
          summary: OIDC session not found
          description: >
            No valid OIDC session was found for the provided `state` and provider. 
            This usually happens if the user attempts to reuse a session that does not exist or has already been removed.
            The user should restart the sign-in process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json: 
              schema: 
                $ref: '#/components/schemas/OIDCSessionNotFoundError'
        '400':
          summary: Invalid or expired OIDC session
          description: >
            The OIDC session is invalid. This can occur if:
            - The session has already been consumed (used previously for authentication).
            - The session has expired (passed the allowed time window).
            
            In both cases, the user must restart the authentication flow.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json: 
              examples:
                OIDCSessionExpired:
                  $ref: '#/components/examples/OIDCSessionExpiredErrorExample'
                OIDCSessionConsumed:
                  $ref: '#/components/examples/OIDCSessionConsumedErrorExample'
              schema: 
                oneOf:
                  - $ref: '#/components/schemas/OIDCSessionExpiredError'
                  - $ref: '#/components/schemas/OIDCSessionConsumedError'
        '401':
          summary: Unauthorized - failed authentication with Google
          description: >
            Authentication with the OIDC provider (Google) failed. 
            This can happen if:
            - The authorization code is invalid.
            - The ID token fails validation.
            - Token exchange with Google was unsuccessful.
            
            The user cannot be authenticated until a valid authorization code is provided.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json: 
              schema: 
                oneOf:
                  - $ref: '#/components/schemas/OIDCFailedAuthenticationError'
  /oidc/github/auth-url:
    get:
      tags: [ðŸ¤ OIDC Authentication]
      summary: Generate GitHub OIDC authorization URL
      description: >
        Initiates the OAuth 2.0 Authorization Code Flow with PKCE for GitHub sign-in.
        This endpoint generates a unique `state` and `code_challenge`, stores them in the database as an OIDC session, and redirects the client to the GitHub OAuth 2.0 authorization endpoint.
        
        The `state` is used to prevent CSRF attacks, and `code_challenge` is part of PKCE to enhance security.

        **Behavior:**
        - Returns an HTTP 307 redirect to the GitHub authorization URL.
        - Sets caching headers to prevent storing sensitive information.
        - No JSON body is returned.
        
        **Authorization URL parameters sent to GitHub:**
        - `client_id`: GitHub OAuth App client ID
        - `redirect_uri`: Callback URI registered in GitHub OAuth App
        - `scope`: Requested access scopes (`user read:user user:email`)
        - `state`: Randomly generated string to prevent CSRF
        - `code_challenge` and `code_challenge_method`: PKCE parameters
        - `allow_signup`: Whether GitHub should prompt to create a new account (`true`)
        - `access_type`: Offline access for refresh tokens (`offline`)
        - `prompt`: Account selection prompt (`select_account`)

      responses:
        '307':
          description: Redirects the client to GitHub OAuth 2.0 authorization URL
          headers:
            Location:
              description: The GitHub authorization URL
              schema:
                type: string
                example: >
                  https://github.com/login/oauth/authorize?client_id=YOUR_CLIENT_ID&redirect_uri=https%3A%2F%2Fyourapp.com%2Fauth%2Fgithub%2Fcallback&scope=user%20read%3Auser%20user%3Aemail&state=RANDOM_STATE&code_challenge=RANDOM_CODE_CHALLENGE&code_challenge_method=S256&allow_signup=true&access_type=offline&prompt=select_account
          content: {}
        '500':
          description: Server error occurred while generating GitHub authorization URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerError'
  /oidc/github/callback:
      get:
        tags: [ðŸ¤ OIDC Authentication]
      summary: Authenticate user via Github OIDC callback
      description: >
        Handles the callback from Github after user authorization.
        Expects `code` and `state` query parameters returned by Github. 
        
        **Flow:**
        1. Verify that the `state` exists, has not expired, and has not been consumed.
        2. Exchange the authorization code for tokens (access token, refresh token, ID token).
        3. Validate the ID token against Github's JWKS endpoint and verify claims.
        4. Create or find a corresponding user in the local database.
        5. Set authentication cookies (`accessToken` and `refreshToken`).
        6. Return a JSON response indicating successful login.

      parameters:
        - name: code
          in: query
          required: true
          description: Authorization code returned by Github
          schema:
            type: string
        - name: state
          in: query
          required: true
          description: Unique state generated during the authorization request
          schema:
            type: string

      responses:
        '200':
          summary: Authentication successful via Github OIDC
          description: >
            The user has been successfully authenticated using Github as an OpenID Connect (OIDC) provider. 
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginSuccessResponse'
        '404':
          summary: OIDC session not found
          description: >
            No valid OIDC session was found for the provided `state` and provider. 
            This usually happens if the user attempts to reuse a session that does not exist or has already been removed.
            The user should restart the sign-in process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json: 
              schema: 
                $ref: '#/components/schemas/OIDCSessionNotFoundError'
        '400':
          summary: Invalid or expired OIDC session
          description: >
            The OIDC session is invalid. This can occur if:
            - The session has already been consumed (used previously for authentication).
            - The session has expired (passed the allowed time window).
            
            In both cases, the user must restart the authentication flow.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json: 
              examples:
                OIDCSessionExpired:
                  $ref: '#/components/examples/OIDCSessionExpiredErrorExample'
                OIDCSessionConsumed:
                  $ref: '#/components/examples/OIDCSessionConsumedErrorExample'
              schema: 
                oneOf:
                  - $ref: '#/components/schemas/OIDCSessionExpiredError'
                  - $ref: '#/components/schemas/OIDCSessionConsumedError'
        '401':
          summary: Unauthorized - failed authentication with Google
          description: >
            Authentication with the OIDC provider (Google) failed. 
            This can happen if:
            - The authorization code is invalid.
            - The ID token fails validation.
            - Token exchange with Google was unsuccessful.
            
            The user cannot be authenticated until a valid authorization code is provided.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json: 
              schema: 
                oneOf:
                  - $ref: '#/components/schemas/OIDCFailedAuthenticationError'

components:
  # REPONSES
  responses:
    # TOKEN UNAUTHORIZED RESPONSES
    InvalidAccessJwtToken:
      summary: Invalid or expired access token
      description: >
        Indicates that the access token provided in the request cookie (`accessToken`) 
        is missing, invalid, expired, or not associated with a valid user session.  
        This response occurs when authentication fails during the verification of the primary
        access JWT used to authorize protected API endpoints.

        ### Validation logic
        The authentication middleware extracts and validates the `accessToken` cookie
        using the Access JWT Passport strategy.  
        Several checks are performed to ensure the tokenâ€™s authenticity and that the session and user
        referenced by it are still valid:

        1. **Missing Token** â€” The `accessToken` cookie is not present in the request.  
          â†’ `AuthenticationTokenNotFoundError`

        2. **Invalid Token Type** â€” The decoded JWT does not represent an `"access"` token.  
          â†’ `AccessTokenTypeError`

        3. **User Not Found** â€” The user associated with the token no longer exists in the system.  
          â†’ `AuthenticationTokenUserNotFoundError`

        4. **Invalid or Expired Session** â€” The session (`sessionId`) referenced in the token payload
          does not exist, has expired, or was invalidated (e.g., after logout).  
          â†’ `AuthenticationTokenInvalidSessionError`

        5. **Session Mismatch** â€” The `userId` embedded in the token does not match the `userId`
          associated with the active session.  
          â†’ `AuthenticationTokenSessionMismatchError`

        6. **Invalid Token Format** â€” The JWT is malformed or fails RS256 signature verification using
          the configured public key.  
          â†’ `AuthenticationTokenInvalidTokenErorr`

        7. **Expired Token** â€” The JWTâ€™s expiration claim (`exp`) has passed.  
          â†’ `AuthenticationTokenExpiredError`

        ### Example scenario
        After a successful login, the server issues an `accessToken` and `refreshToken`.
        The `accessToken` is a short-lived RS256-signed JWT that authenticates the user
        for protected endpoints.  
        If the token is expired, invalid, or the user/session no longer exists,
        the request will fail with this response.  
        Clients should then attempt to refresh the token (using `/auth/refresh`) or reauthenticate.
      headers:
        X-Request-Id:
          $ref: "#/components/headers/XRequestId"
      content:
        application/json:
          schema:
            oneOf:
              - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
              - $ref: "#/components/schemas/AccessTokenTypeError"
              - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidSessionError"
              - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
              - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
          examples:
            AuthenticationTokenNotFound:
              $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
            AccessTokenType:
              $ref: "#/components/examples/AccessTokenTypeErrorExample"
            AuthenticationTokenUserNotFound:
              $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
            AuthenticationTokenInvalidSession:
              $ref: "#/components/examples/AuthenticationTokenInvalidSessionErrorExample"
            AuthenticationTokenSessionMismatch:
              $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
            AuthenticationTokenInvalidToken:
              $ref: "#/components/examples/AuthenticationTokenInvalidErrorExample"
            AuthenticationTokenExpired:
              $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
    InvalidMFAJwtToken:
      description: >
        Indicates that the MFA (Multi-Factor Authentication) token provided in the request cookie (`mfaToken`) 
        is missing, invalid, expired, or does not match the expected format or purpose.  
        This error occurs during the validation of the MFA JWT used to finalize a login or password reset flow.  
        The system enforces strict checks to ensure the integrity and purpose of the MFA token before allowing 
        access to sensitive endpoints such as `/mfa/verify-login` or `/mfa/verify-forgot-password`.

        ### Validation logic
        The authentication middleware extracts and verifies the `mfaToken` cookie using a dedicated JWT strategy.
        During this process, several error conditions can occur:
        
        1. **Missing Token** â€” The `mfaToken` cookie is not present in the request.  
          â†’ `AuthenticationTokenNotFoundError`
        
        2. **Invalid Token Type** â€” The decoded JWT does not represent a token of type `"mfa"`.  
          â†’ `MFATokenTypeError`
        
        3. **Invalid Endpoint** â€” The token is being used on an endpoint that does not match its allowed purpose  
          (e.g., a token intended for `"forgot_password"` is sent to `/mfa/verify-login`).  
          â†’ `MFATokenInvalidEndpointError`
        
        4. **Purpose Mismatch** â€” The tokenâ€™s internal `purpose` field does not match the expected endpoint purpose.  
          â†’ `MFATokenInvalidTokenPurposeError`
        
        5. **User Not Found** â€” The user referenced in the token payload no longer exists in the system.  
          â†’ `AuthenticationTokenUserNotFoundError`
        
        6. **Invalid or Expired Session** â€” The MFA session record associated with the token (`mfaSessionId` or `jti`)  
          could not be found, was already consumed, or is expired.  
          â†’ `AuthenticationTokenInvalidSessionError`
        
        7. **Session Mismatch** â€” The user ID in the token does not match the user ID of the MFA session.  
        â†’ `AuthenticationTokenSessionMismatchError`
    
        8. **Invalid Token Format** â€” The JWT is malformed or fails signature verification.  
          â†’ `AuthenticationTokenInvalidTokenErorr`
        
        9. **Expired Token** â€” The JWT has passed its expiration time (`exp` claim).  
          â†’ `AuthenticationTokenExpiredError`

        ### Example scenario
        When a user successfully passes the first authentication step (e.g., email + password),
        the backend issues a short-lived `mfaToken`.  
        This token is stored in a cookie and must be presented when verifying the MFA code.
        If the token is invalid, expired, or used on the wrong endpoint, this response is returned.
      headers:
        X-Request-Id:
          $ref: "#/components/headers/XRequestId"
      content:
        application/json:
          schema:
            oneOf:
              - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
              - $ref: "#/components/schemas/MFATokenTypeError"
              - $ref: "#/components/schemas/MFATokenInvalidEndpointError"
              - $ref: "#/components/schemas/MFATokenInvalidTokenPurposeError"
              - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidSessionError"
              - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
              - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
          examples:
            AuthenticationTokenNotFound:
              $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
            MFATokenType:
              $ref: "#/components/examples/MFATokenTypeErrorExample"
            MFATokenInvalidEndpoint:
              $ref: "#/components/examples/MFATokenInvalidEndpointErrorExample"
            MFATokenInvalidTokenPurpose:
              $ref: "#/components/examples/MFATokenInvalidTokenPurposeErrorExample"
            AuthenticationTokenUserNotFound:
              $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
            AuthenticationTokenInvalidSession:
              $ref: "#/components/examples/AuthenticationTokenInvalidSessionErrorExample"
            AuthenticationTokenSessionMismatch:
              $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
            AuthenticationTokenInvalidToken:
              $ref: "#/components/examples/AuthenticationTokenInvalidErrorExample"
            AuthenticationTokenExpired:
              $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
    InvalidMagicLinkJwtToken:
      summary: Invalid or expired Magic Link token
      description: >
        Indicates that the Magic Link token provided in the request (`req.params.token`) 
        is missing, invalid, expired, or not associated with a valid Magic Link session.  
        This response occurs when authentication fails during the verification of the JWT 
        used for passwordless login or password reset flows.

        ### Validation logic
        The authentication middleware extracts and validates the Magic Link token using 
        the Passport JWT strategy (`magic-link-token`). Several checks are performed 
        to ensure the tokenâ€™s authenticity and that the session and user referenced by it 
        are still valid:

        1. **Missing Token** â€” The `token` parameter is not present in the request URL.  
          â†’ `AuthenticationTokenNotFoundError`

        2. **Invalid Token Type** â€” The decoded JWT does not represent a `"magic-link"` token.  
          â†’ `MagicLinkTokenTypeError`

        3. **User Not Found** â€” The user associated with the token no longer exists in the system.  
          â†’ `AuthenticationTokenUserNotFoundError`

        4. **Invalid or Expired Session** â€” The Magic Link session (`magicLinkSessionId`) 
          referenced in the token payload does not exist, has expired, or was already consumed.  
          â†’ `AuthenticationTokenInvalidSessionError`

        5. **Session Mismatch** â€” The `userId` embedded in the token does not match the `userId` 
          associated with the active Magic Link session.  
          â†’ `AuthenticationTokenSessionMismatchError`

        6. **Invalid Token Format** â€” The JWT is malformed or fails HS256 signature verification using
          the configured secret key.  
          â†’ `AuthenticationTokenInvalidTokenErorr`

        7. **Expired Token** â€” The JWTâ€™s expiration claim (`exp`) has passed.  
          â†’ `AuthenticationTokenExpiredError`

        ### Example scenario
        After initiating a passwordless login or a password reset flow, the server issues a 
        short-lived Magic Link token (`magic-link`) and associates it with a Magic Link session.  
        The token is sent to the user's email as part of a link.  
        When the client clicks the link, the token is verified to authenticate the user.  

        If the token is missing, expired, invalid, or the session/user no longer exists, 
        the request will fail with this response.  
        Clients should then prompt the user to request a new Magic Link.
      headers:
        X-Request-Id:
          $ref: "#/components/headers/XRequestId"
      content:
        application/json:
          examples:
            AuthenticationTokenNotFound:
              $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
            MagicLinkTokenType:
              $ref: "#/components/examples/MagicLinkTokenTypeErrorExample"
            AuthenticationTokenUserNotFound:
              $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
            AuthenticationTokenInvalidSession:
              $ref: "#/components/examples/AuthenticationTokenInvalidSessionErrorExample"
            AuthenticationTokenSessionMismatch:
              $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
            AuthenticationTokenInvalidToken:
              $ref: "#/components/examples/AuthenticationTokenInvalidErrorExample"
            AuthenticationTokenExpired:
              $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
          schema:
            oneOf:
              - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
              - $ref: "#/components/schemas/MagicLinkTokenTypeError"
              - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidSessionError"
              - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
              - $ref: "#/components/schemas/AuthenticationTokenExpiredError"      
    InvalidRefreshJwtToken:
      summary: Invalid or expired refresh token
      description: >
        Indicates that the refresh token provided in the request cookie (`refreshToken`) 
        is missing, invalid, expired, or not associated with a valid user session.  
        This response occurs when authentication fails during the verification of the refresh JWT,
        which is used to obtain new access tokens without requiring the user to log in again.

        ### Validation logic
        The authentication middleware extracts and validates the `refreshToken` cookie using
        the Passport JWT strategy (`refresh-token`). Several checks are performed to ensure 
        the tokenâ€™s authenticity and that the session and user referenced by it are still valid:

        1. **Missing Token** â€” The `refreshToken` cookie is not present in the request.  
          â†’ `AuthenticationTokenNotFoundError`

        2. **Invalid Token Type** â€” The decoded JWT does not represent a `"refresh"` token.  
          â†’ `RefreshTokenTypeError`

        3. **User Not Found** â€” The user associated with the token no longer exists in the system.  
          â†’ `AuthenticationTokenUserNotFoundError`

        4. **Invalid Session** â€” The session (`sessionId`) referenced in the token payload
          does not exist or has been invalidated (e.g., user logged out).  
          â†’ `RefreshTokenInvalidSessionError`

        5. **Expired Session** â€” The session associated with the refresh token has expired.  
          â†’ `RefreshTokenExpiredSessionError`

        6. **Session Mismatch** â€” The `userId` embedded in the token does not match the `userId`
          associated with the active session.  
          â†’ `AuthenticationTokenSessionMismatchError`

        7. **Invalid Token Format** â€” The JWT is malformed or fails RS256 signature verification using
          the configured public key.  
          â†’ `AuthenticationTokenInvalidErorr`

        8. **Expired Token** â€” The JWTâ€™s expiration claim (`exp`) has passed.  
          â†’ `AuthenticationTokenExpiredError`

        ### Example scenario
        After a successful login, the server issues both an `accessToken` and a `refreshToken`.  
        The `refreshToken` is a long-lived RS256-signed JWT that allows the client to obtain new 
        access tokens without requiring credentials again.  

        If the refresh token is missing, expired, invalid, or the session/user no longer exists,
        the request to `/auth/refresh` will fail with this response.  
        Clients should prompt the user to log in again to obtain fresh tokens.
      headers:
        X-Request-Id:
          $ref: "#/components/headers/XRequestId"
        Set-Cookie:
          $ref: "#/components/headers/InvalidateAuthenticationCookies"
      content:
        application/json:
          schema:
            oneOf:
              - $ref: "#/components/schemas/RefreshTokenInvalidSessionError"
              - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
              - $ref: "#/components/schemas/RefreshTokenTypeError"
              - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
              - $ref: "#/components/schemas/RefreshTokenExpiredSessionError"
              - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
              - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
          examples:
            RefreshTokenInvalidSessionError:
              $ref: "#/components/examples/RefreshTokenInvalidSessionErrorExample"
            AuthenticationTokenNotFoundError:
              $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
            RefreshTokenTypeError:
              $ref: "#/components/examples/RefreshTokenTypeErrorExample"
            AuthenticationTokenUserNotFoundError:
              $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
            RefreshTokenExpiredSessionError:
              $ref: "#/components/examples/RefreshTokenExpiredSessionErrorExample"
            AuthenticationTokenSessionMismatchError:
              $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
            AuthenticationTokenInvalidErorr:
              $ref: "#/components/examples/AuthenticationTokenInvalidErrorExample"
            AuthenticationTokenExpired:
              $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
  # SCHEMAS
  schemas:
    # REUSABLE DATA
    UserData:
      type: object
      required:
        - _id
        - name
        - email
        - isEmailVerified
        - userPreferences
        - createdAt
        - updatedAt
      properties:
        _id:
          type: string
          example: 6904fb216bdaf225b3726294
        name:
          type: string
          example: user
        email:
          type: string
          example: marinescua914@gmail.com
        isEmailVerified:
          type: boolean
          example: false
        userPreferences:
          type: object
          required:
            - enable2FA
            - emailNotification
          properties:
            enable2FA:
              type: boolean
              example: false
            emailNotification:
              type: boolean
              example: true
        createdAt:
          type: string
          format: date-time
          example: 2025-10-31T18:08:33.919Z
        updatedAt:
          type: string
          format: date-time
          example: 2025-10-31T18:08:33.919Z
    ResponseMetadata:
      type: object
      description: >
        Contains metadata related to the request and response, such as timestamps, request tracking IDs, and result counts.
      required:
        - timestamp
        - requestId
      properties:
        timestamp:
          type: string
          format: date-time
          description: The exact server-side timestamp when the response was generated.
          example: 2025-10-31T18:08:35.135Z
        requestId:
          type: string
          description: A unique identifier for the request, useful for tracing logs and debugging.
          example: 627c83c6ac314a94bd9348d78
        count:
          type: integer
          description: The total number of items returned in the response (if applicable).
          example: 42
    PasskeyData:
      type: object
      required:
      - _id
      - userID
      - credentialID
      - credentialPublicKey
      - credentialType
      - publicKeyAlgorithm
      - counter
      - transports
      - authenticatorAttachment
      - aaguid
      - createdAt
      description: >
        Represents a registered WebAuthn passkey credential associated with a user account.  
        Each passkey stores the credentialâ€™s unique identifiers, cryptographic parameters, and metadata about its usage and origin device.
      properties:
        _id:
          type: string
          format: objectId
          description: Unique identifier of the passkey record in the database.
          example: "64fae2d9c6b50d2a4bf1a39b"
        userID:
          type: string
          format: objectId
          description: Unique identifier of the user who owns this passkey.
          example: "64fae2d9c6b50d2a4bf1a39c"
        credentialID:
          type: string
          description: Base64URL-encoded credential ID returned by the authenticator.
          example: "BQoX8jNYXn_8FZ6rYc3K0Q"
        credentialPublicKey:
          type: string
          description: Base64-encoded public key associated with the credential used for authentication.
          example: "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQE..."
        credentialType:
          type: string
          enum: ["public-key"]
          description: Type of WebAuthn credential. Always `"public-key"`.
          example: "public-key"
        publicKeyAlgorithm:
          type: integer
          description: >
            COSE algorithm identifier used for the credentialâ€™s public key.
            Common values include `-7` (ES256), `-257` (RS256), or `-8` (EdDSA).
          example: -7
        counter:
          type: integer
          description: Monotonically increasing counter maintained by the authenticator to prevent replay attacks.
          example: 12
        transports:
          type: array
          description: >
            List of supported authenticator transports that can be used to communicate with the credential.
            Examples include `["usb", "ble", "nfc", "internal"]`.
          items:
            type: string
            enum: ["usb", "nfc", "ble", "internal", "hybrid"]
          example: ["internal"]
        authenticatorAttachment:
          type: string
          description: >
            Describes the attachment modality of the authenticator.  
            `"platform"` means a device-integrated authenticator (e.g., Touch ID, Windows Hello).  
            `"cross-platform"` means an external authenticator (e.g., YubiKey, phone-based passkey).
          enum: ["platform", "cross-platform"]
          example: "platform"
        aaguid:
          type: object
          description: >
            Information about the authenticatorâ€™s Attestation AAGUID and provider identity.
          properties:
            aaguid:
              type: string
              description: Authenticator Attestation GUID uniquely identifying the authenticator model.
              example: "adce0002-35bc-c60a-648b-0b25f1f05503"
            name:
              type: string
              description: Human-readable name of the authenticator provider or model.
              example: "Apple Face ID / Touch ID"
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the passkey was first registered.
          example: "2025-11-01T18:30:22.123Z"
        lastUsed:
          type: string
          format: date-time
          description: Timestamp of the most recent use of this passkey for authentication.
          example: "2025-11-03T10:45:17.552Z"
    # REQUEST BODY
    UserRegistrationRequestBody:
      type: object
      required:
        - name
        - email
        - password
        - confirmPassword
      properties:
        name:
          type: string
          description: The user's full name
          minLength: 1
          maxLength: 64
          example: John Doe
        email:
          type: string
          format: email
          minLength: 1
          maxLength: 64
          example: john.doe@example.com
        password:
          type: string
          minLength: 8
          pattern: ^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{}|\\;:\'",.<>/?]).{8,}$
          description: Must start with a capital letter and contain at least one special character
          example: Password@123
        confirmPassword:
          type: string
          minLength: 8
          pattern: ^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{}|\\;:\'",.<>/?]).{8,}$
          description: Must match the password field
          example: Password@123
    UserLoginRequestBody:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          minLength: 1
          maxLength: 64
          example: john.doe@example.com
        password:
          type: string
          minLength: 8
          pattern: ^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{}|\\;:\'",.<>/?]).{8,}$
          description: Must start with a capital letter and contain at least one special character
          example: Password@123
    ForgotPasswordRequestBody:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          example: john.doe@gmail.com
    ResetPasswordRequestBody:
      type: object
      required:
        - verificationCode
        - password
      properties:
        verificationCode:
          type: string
          minLength: 1
          maxLength: 64
          example: 8ee6af17747140d8951121739
        password:
          type: string
          minLength: 8
          pattern: ^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{}|\\;:\'",.<>/?]).{8,}$
          description: Must start with a capital letter and contain at least one special character
          example: Password@123
    MagicLinkSignUpRequestBody:
      type: object
      required:
        - name
        - email
      properties:
        name:
          type: string
          description: The user's full name
          minLength: 1
          maxLength: 64
          example: John Doe
        email:
          type: string
          format: email
          minLength: 1
          maxLength: 64
          example: john.doe@example.com
    MagicLinkSignInRequestBody:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          minLength: 1
          maxLength: 64
          example: john.doe@example.com
    PasskeyCompletRegistrationRequestBody:
      type: object
      required:
        - id
        - rawId
        - type
        - response
      properties:
        id:
          type: string
          description: Base64Url-encoded credential ID generated by the authenticator.
        rawId:
          type: string
          description: Raw Base64Url-encoded credential ID.
        type:
          type: string
          enum: ["public-key"]
          description: Must always be "public-key".
        response:
          type: object
          required:
            - attestationObject
            - clientDataJSON
          properties:
            attestationObject:
              type: string
              description: Base64Url-encoded attestation object provided by the authenticator.
            clientDataJSON:
              type: string
              description: Base64Url-encoded JSON object with client data.
            authenticatorData:
              type: string
              description: Optional authenticator data returned by the device.
            publicKey:
              type: string
              description: Optional public key generated by the authenticator.
            publicKeyAlgorithm:
              type: integer
              description: Optional algorithm identifier for the public key.
            transports:
              type: array
              description: Optional transport methods supported by the authenticator.
              items:
                type: string
                enum: ["ble", "cable", "hybrid", "internal", "nfc", "smart-card", "usb"]
        authenticatorAttachment:
          type: string
          description: Optional attachment modality of the authenticator.
          enum: ["cross-platform", "platform"]
        clientExtensionResults:
          type: object
          description: Optional results of any WebAuthn client extensions.
          properties:
            appid:
              type: boolean
              description: Indicates if the "appid" extension was used.
            credProps:
              type: object
              description: Credential properties returned by the client.
              properties:
                rk:
                  type: boolean
                  description: Indicates if the credential is resident.
            hmacCreateSecret:
              type: boolean
              description: Indicates if the "hmacCreateSecret" extension was used.
    PasskeyCompletAuthenticationRequestBody:
      type: object
      required:
        - id
        - rawId
        - type
        - response
      description: >
        Represents the **WebAuthn authentication response** sent by the browser after
        calling `navigator.credentials.get()` during the passkey sign-in process.
        This object contains all cryptographic data needed by the backend to verify
        the authenticity and integrity of the authentication ceremony.
      properties:
        id:
          type: string
          description: |
            The base64url-encoded credential ID uniquely identifying the passkey credential.
          example: "hT1lYyBBtU4QxZ5L5RjYuw"
        rawId:
          type: string
          description: |
            The raw credential ID in base64url format. Usually identical to `id` but encoded differently.
          example: "hT1lYyBBtU4QxZ5L5RjYuw"
        type:
          type: string
          enum: ["public-key"]
          description: The credential type. For WebAuthn, always `"public-key"`.
          example: "public-key"
        authenticatorAttachment:
          type: string
          enum: ["cross-platform", "platform"]
          description: |
            Indicates the attachment modality of the authenticator:
            - `"platform"`: built into the device (e.g. Touch ID, Windows Hello)
            - `"cross-platform"`: external authenticator (e.g. security key)
          example: "platform"
        clientExtensionResults:
          type: object
          description: Results from any WebAuthn extensions used during authentication.
          properties:
            appid:
              type: boolean
              description: Indicates if the AppID extension was used.
              example: false
            credProps:
              type: object
              description: Credential properties returned by the authenticator.
              properties:
                rk:
                  type: boolean
                  description: Whether the credential is a resident key.
                  example: true
            hmacCreateSecret:
              type: boolean
              description: Indicates if the `hmac-secret` extension was used.
              example: false
        response:
          type: object
          required:
            - clientDataJSON
            - authenticatorData
            - signature
            - userHandle
          description: |
            Contains the raw cryptographic materials returned by the authenticator, required for verifying the authentication response.
          properties:
            clientDataJSON:
              type: string
              description: Base64url-encoded JSON object that was passed to the authenticator.
              example: "eyJ0eXBlIjoid2ViYXV0aG4uZ2V0Iiwib3JpZ2luIjoiaHR0cHM6Ly9hcHAuZXhhbXBsZS5jb20ifQ"
            authenticatorData:
              type: string
              description: Base64url-encoded authenticator data containing RP ID hash, flags, and signature counter.
              example: "SZYNfIE2DkFyGJvhC4LwE8EAAAA="
            signature:
              type: string
              description: Base64url-encoded signature that proves possession of the private key.
              example: "MEUCIQD7G8rLC4Y..."
            userHandle:
              type: string
              description: Base64url-encoded identifier for the user account associated with the credential.
              example: "dXNlcl8xMjM0NQ=="
    # RESPONSES
    RegistrationSuccessReponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [201]
          example: 201
        message:
          type: string
          example: Registration successful. A verification email has been sent to your email address.
        data:
          type: object
          properties:
            user:
              $ref: "#/components/schemas/UserData"
            isVerificationEmailSend:
              type: boolean
              example: true
            nextStep:
              type: string
              enum: ["CONFIRM_SIGN_UP"]
              example: CONFIRM_SIGN_UP
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    LoginEmailVerificationPendingResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Authentication pending, your email address has not yet been verified. Please confirm your email to proceed.
        data:
          type: object
          properties:
            nextStep:
              type: string
              enum: ["CONFIRM_SIGN_UP"]
              example: CONFIRM_SIGN_UP
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    LoginSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Authentication successful, you have been signed in successfully.
        data:
          type: object
          required:
            - mfaRequired
            - nextStep
            - user
          properties:
            user:
              $ref: "#/components/schemas/UserData"
            nextStep:
              type: string
              enum: ["OK"]
              example: OK
            mfaRequired:
              type: boolean
              enum: [false]
              example: false
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    MFAPendingResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Two-factor authentication required. Please enter your verification code to complete this process.
        data:
          type: object
          required:
            - mfaRequired
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["MFA_REQUIRED"]
              example: MFA_REQUIRED
            mfaRequired:
              type: boolean
              enum: [true]
              example: true
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    EmailConfirmedSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Email address successfully verified. You can now proceed to login.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["CONFIRMED_EMAIL_RETURN_TO_LOGIN"]
              example: CONFIRMED_EMAIL_RETURN_TO_LOGIN
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    ForgotPasswordSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Password reset request successfully processed. Please check your email for further instructions.
        data:
          type: object
          required:
            - nextStep
            - mfaRequired
          properties:
            nextStep:
              type: string
              enum: ["OK"]
              example: OK
            mfaRequired:
              type: boolean
              enum: [false]
              example: false
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    ResetPasswordSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Password reset completed. If you didnâ€™t request this change, please contact support immediately.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["OK"]
              example: OK
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    RefreshTokenEndpointSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Access token successfully refreshed. Your session remains active.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["OK"]
              example: OK
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    LogoutSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Logout successful, you have been securely signed out.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["LOGOUT"]
              example: LOGOUT
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    MagicLinkSignUpSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [201]
          example: 201
        message:
          type: string
          example: We've sent a magic link to your email. Click it to successfully finish your registration process.
        data:
          type: object
          properties:
            user:
              $ref: "#/components/schemas/UserData"
            isMagicLinkEmailSend:
              type: boolean
              example: true
            nextStep:
              type: string
              enum: ["CHECK_EMAIL_FOR_MAGIC_LINK"]
              example: CHECK_EMAIL_FOR_MAGIC_LINK
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    MagicLinkSignInSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: We've sent a magic link to your email. Click it to successfully finish your registration process.
        data:
          type: object
          properties:
            isMagicLinkEmailSend:
              type: boolean
              example: true
            nextStep:
              type: string
              enum: ["CHECK_EMAIL_FOR_MAGIC_LINK"]
              example: CHECK_EMAIL_FOR_MAGIC_LINK
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    MfaSetupResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: We've sent a magic link to your email. Click it to successfully finish your registration process.
        data:
          type: object
          required:
            - secret
            - qrImageUrl
          properties:
            secret:
              type: string
              description: Base32-encoded TOTP secret for the user. This secret is used to generate OTP codes.
              pattern: "^[A-Z2-7]+=*$"
              example: "JBSWY3DPEHPK3PXP"
            qrImageUrl:
              type: string
              description: Base64-encoded PNG image of the QR code for TOTP setup. Can be rendered in clients as an image.
              format: byte
              example: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..."
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    MFAVerifySetupSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: MFA setup completed successfully.
        data:
          type: object
          required:
            - userPreferences
          properties:
            userPreferences:
              type: object
              required:
                - enabled2FA
                - backupCodes
              properties:
                enable2FA:
                  type: boolean
                  enum: [true]
                  example: true
                backupCodes:
                  type: array
                  items:
                    type: string
                    example:
                    - "4F9K2M8Q1"
                    - "A7B3C1D9E"
                    - "X2Y5Z8W1Q"
                    - "9G1H3J7K2"
                    - "L4M6N8O2P"
                    - "Q7R2S9T3V"
                    - "3B8F1D6H2"
                    - "Z5X9C2V7L"
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    MFARevokeSuccessReponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Two-factor authentication has been successfully disabled for your account.
        data:
          type: object
          properties:
            user:
              $ref: "#/components/schemas/UserData"
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    MFARequestChangePasswordSuccessReponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Password reset request successfully processed. Please check your email for further instructions.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ['OK']
              example: OK
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    # PASSKEY RESPONSES
    PasskeyGenerateSignUpSessionSuccessResponse:
      type: object
      properties:
        statusCode:
          type: integer
          description: HTTP status code of the response.
          example: 201
        success:
          type: boolean
          description: Indicates that the request was successful.
          example: true
        message:
          type: string
          description: Human-readable message describing the response.
          example: "Passkey registration session has been successfully created."
        data:
          type: object
          properties:
            publicKeyOpts:
              type: object
              description: WebAuthn options to complete the passkey registration on the client side.
              properties:
                challenge:
                  type: string
                  description: Base64-encoded challenge for WebAuthn registration.
                  example: "sK5JeWWiLW0duSUWmv9W9Ck5LGZWTXCSZW8c34Fioa0"
                rp:
                  type: object
                  properties:
                    name:
                      type: string
                      description: >
                        The display name of the application (Relying Party). 
                        This is shown to the user during registration/authentication.
                      example: "app.example.com"
                    id:
                      type: string
                      description: >
                        The unique identifier of the Relying Party, usually the domain name. 
                        Used by the browser to validate the registration request and prevent phishing.
                      example: "app.example.com"
                user:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Base64 or URL-safe encoded user ID
                      example: "aQoHTR7y_Sec3D9B"
                    name:
                      type: string
                      example: "john.doe@gmail.com"
                    displayName:
                      type: string
                      example: "USER_01"
                pubKeyCredParams:
                  type: array
                  description: >
                    The cryptographic algorithms supported by the relying party for the public-key credential. 
                    Each object specifies the algorithm (`alg`) and type (`type`). 
                    These algorithms correspond to the COSE algorithm identifiers:
                      -7: ES256 (ECDSA w/ SHA-256)
                      -8: EdDSA (Ed25519)
                      -257: RS256 (RSASSA-PKCS1-v1_5 w/ SHA-256)
                  items:
                    type: object
                    properties:
                      alg:
                        type: integer
                        example: -7
                      type:
                        type: string
                        example: "public-key"
                    required:
                      - alg
                      - type
                timeout:
                  type: integer
                  example: 60000
                  description: Timeout for the operation in milliseconds
                attestation:
                  type: string
                  enum: ['direct']
                  example: "direct"
                excludeCredentials:
                  type: array
                  items:
                    type: object
                authenticatorSelection:
                  type: object
                  properties:
                    residentKey:
                      type: string
                      enum: ['required']
                      example: "required"
                    requireResidentKey:
                      type: boolean
                      enum: [true]
                      example: true
                    userVerification:
                      type: string
                      enum: ['required']
                      example: "required"
                extensions:
                  type: object
                  properties:
                    credProps:
                      type: boolean
                      enum: [true]
                      example: true
                hints:
                  type: array
                  items:
                    type: string
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    PasskeyGenerateSignInSessionSuccessResponse:
      type: object
      description: Response returned when a new passkey authentication session has been successfully created.
      required:
        - statusCode
        - success
        - message
        - data
        - metadata
      properties:
        statusCode:
          type: integer
          example: 201
          description: HTTP status code indicating that the passkey session was successfully created.
        success:
          type: boolean
          example: true
          description: Indicates whether the operation was successful.
        message:
          type: string
          example: Passkey authentication session has been successfully created.
          description: A human-readable message describing the result of the operation.
        data:
          type: object
          description: Contains the created public key credential request options used by the client to proceed with WebAuthn authentication.
          properties:
            publicKeyCredentialRequestOptions:
              type: object
              description: Options provided to the client for completing the WebAuthn authentication ceremony.
              properties:
                rpId:
                  type: string
                  example: app.example.com
                  description: The relying party identifier, usually the domain name of your web application.
                challenge:
                  type: string
                  example: -IONEyb0_A3Ek4Nn9l_vRaC-_rqUl-F7zBwx68qePSw
                  description: A unique cryptographic challenge generated by the server to prevent replay attacks.
                allowCredentials:
                  type: array
                  description: |
                    A list of previously registered credentials that are allowed for authentication.  
                    If empty, the authenticator may select any credential associated with the user.
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                        description: Base64URL-encoded identifier of the allowed credential.
                        example: QWERTY12345==
                      type:
                        type: string
                        enum: ["public-key"]
                        example: public-key
                      transports:
                        type: array
                        items:
                          type: string
                          enum: [ "ble", "cable", "hybrid", "internal", "nfc","smart-card", "usb" ]
                          example: internal
                        description: Optional list of transports supported by this credential.
                timeout:
                  type: integer
                  example: 60000
                  description: The time, in milliseconds, that the client is allowed to take to complete the authentication.
                userVerification:
                  type: string
                  enum: ["required", "preferred", "discouraged"]
                  example: required
                  description: Indicates whether the authenticator must perform user verification.
              required:
                - rpId
                - challenge
                - allowCredentials
                - timeout
                - userVerification
        metadata:
          metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    PasskeyGenerateRemoveKeySuccessResponse:
      type: object
      description: Response returned when a new passkey authentication session has been successfully created.
      required:
        - statusCode
        - success
        - message
        - data
        - metadata
      properties:
        statusCode:
          type: integer
          example: 201
          description: HTTP status code indicating that the passkey session was successfully created.
        success:
          type: boolean
          example: true
          description: Indicates whether the operation was successful.
        message:
          type: string
          example: Passkey remove session has been successfully created.
          description: A human-readable message describing the result of the operation.
        data:
          type: object
          description: Contains the created public key credential request options used by the client to proceed with WebAuthn authentication.
          properties:
            publicKeyCredentialRequestOptions:
              type: object
              description: Options provided to the client for completing the WebAuthn authentication ceremony.
              properties:
                rpId:
                  type: string
                  example: app.example.com
                  description: The relying party identifier, usually the domain name of your web application.
                challenge:
                  type: string
                  example: -IONEyb0_A3Ek4Nn9l_vRaC-_rqUl-F7zBwx68qePSw
                  description: A unique cryptographic challenge generated by the server to prevent replay attacks.
                allowCredentials:
                  type: array
                  description: |
                    A list of previously registered credentials that are allowed for authentication.  
                    If empty, the authenticator may select any credential associated with the user.
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                        description: Base64URL-encoded identifier of the allowed credential.
                        example: QWERTY12345==
                      type:
                        type: string
                        enum: ["public-key"]
                        example: public-key
                      transports:
                        type: array
                        items:
                          type: string
                          enum: [ "ble", "cable", "hybrid", "internal", "nfc","smart-card", "usb" ]
                          example: internal
                        description: Optional list of transports supported by this credential.
                timeout:
                  type: integer
                  example: 60000
                  description: The time, in milliseconds, that the client is allowed to take to complete the authentication.
                userVerification:
                  type: string
                  enum: ["required", "preferred", "discouraged"]
                  example: required
                  description: Indicates whether the authenticator must perform user verification.
              required:
                - rpId
                - challenge
                - allowCredentials
                - timeout
                - userVerification
        metadata:
          metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    PasskeyAddedSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      description: >
        Response returned when a new passkey has been successfully registered and added to the user account.
      properties:
        success:
          type: boolean
          example: true
          description: Indicates whether the operation was successful.
        statusCode:
          type: integer
          example: 201
          description: HTTP status code associated with this response.
        message:
          type: string
          example: "Passkey was successfully added."
          description: Human-readable message describing the result of the operation.
        data:
          type: object
          description: Contains the newly added passkey details.
          properties:
            passkey:
              $ref: '#/components/schemas/PasskeyData'
        metadata:
          $ref: '#/components/schemas/ResponseMetadata'
    PasskeyRemovedSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      description: >
        Response returned when a new passkey has been successfully registered and added to the user account.
      properties:
        success:
          type: boolean
          example: true
          description: Indicates whether the operation was successful.
        statusCode:
          type: integer
          example: 201
          description: HTTP status code associated with this response.
        message:
          type: string
          example: "Passkey  has been successfully removed."
          description: Human-readable message describing the result of the operation.
        data:
          type: object
        metadata:
          $ref: '#/components/schemas/ResponseMetadata'
    PasskeyGetAllPasskeyByUserIdSuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          description: Indicates whether the request was successful.
          example: true
        statusCode:
          type: integer
          description: HTTP status code.
          example: 200
        message:
          type: string
          description: A message summarizing the request result.
          example: "All passkeys were successfully retrieved."
        data:
          type: object
          properties:
            passkeys:
              type: array
              items:
                type: object
                properties:
                  aaguid:
                    type: object
                    properties:
                      name:
                        type: string
                        description: The name of the passkey provider.
                        example: "Google Password Manager"
                      icon_dark:
                        type: string
                        description: The base64 encoded SVG for the dark theme icon.
                        example: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0c..."
                      icon_light:
                        type: string
                        description: The base64 encoded SVG for the light theme icon.
                        example: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0c..."
                  credentialId:
                    type: string
                    description: The unique identifier of the passkey credential.
                    example: "a1b2c3d4e5f6789ghijk01234lm56789"
                  createdAt:
                    type: string
                    format: date-time
                    description: The date and time when the passkey was created.
                    example: "2023-05-01T14:30:00Z"
                  lastUsed:
                    type: string
                    format: date-time
                    description: The date and time when the passkey was last used.
                    example: "2023-10-29T18:15:00Z"
        metadata:
          type: object
          properties:
            requestId:
              type: string
              description: A unique identifier for the request.
              example: "12345-abcde-67890-fghij"
            count:
              type: integer
              description: The total number of passkeys retrieved.
              example: 5
    # SESSION
    GetAllSessionsSuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          description: Indicates whether the operation was successful
          example: true
        statusCode:
          type: integer
          description: HTTP status code of the response
          example: 200
        message:
          type: string
          example: "User sessions retrieved successfully."
        data:
          type: object
          properties:
            sessions:
              type: array
              items:
                type: object
                properties:
                  _id:
                    type: string
                    description: Unique identifier of the session.
                    example: "60c72b2f9f1b2c001c8a3e5f"
                  userId:
                    type: string
                    description: Unique identifier of the user who owns the session.
                    example: "60c72b2f9f1b2c001c8a3e5f"
                  userAgent:
                    type: object
                    properties:
                      browser:
                        type: string
                        example: "Chrome"
                      version:
                        type: string
                        example: "91.0.4472.124"
                      os:
                        type: string
                        example: "Windows 10"
                      platform:
                        type: string
                        example: "Win32"
                  expiredAt:
                    type: string
                    format: date-time
                    description: The expiration date and time of the session.
                    example: "2023-11-01T12:00:00Z"
                  createdAt:
                    type: string
                    format: date-time
                    description: The creation date and time of the session.
                    example: "2023-10-15T08:30:00Z"
                  isCurrent:
                    type: boolean
                    description: Indicates if this is the current session.
                    example: true
        metadata:
          $ref: '#/components/schemas/ResponseMetadata'
    GetCurrentSessionSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          description: Indicates whether the operation was successful
          example: true
        statusCode:
          type: integer
          description: HTTP status code of the response
          example: 200
        message:
          type: string
          example: "User session retrieved successfully."
        data:
          type: object
          properties:
            user:
              $ref: '#/components/schemas/UserData'
        metadata:
          $ref: '#/components/schemas/ResponseMetadata'
    DeleteSessionByIdSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          description: Indicates whether the operation was successful
          example: true
        statusCode:
          type: integer
          description: HTTP status code of the response
          example: 200
        message:
          type: string
          description: A human-readable message describing the result
          example: "User session successfully removed."
        data:
          type: object
          properties:
            nextStep:
              type: string
              nullable: true
              description: >
                If the deleted session was the current session, indicates
                the next action for the client (e.g., LOGIN.LOGOUT).
              example: "LOGOUT"
        metadata:
          $ref: '#/components/schemas/ResponseMetadata'
    # ERRORS
    # GENERAL ERRORS
    InternalServerError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Internal Server Error
        errorCode:
          type: string
          enum: ["INTERNAL_SERVER_ERROR"]
          example: INTERNAL_SERVER_ERROR
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    ForbiddenError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Access denied, you do not have permission to perform this action.
        errorCode:
          type: string
          enum: ["ACCESS_FORBIDDEN"]
          example: ACCESS_FORBIDDEN
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    TooManyRequestsError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Too many requests. Please try again later.
        errorCode:
          type: string
          enum: ["TOO_MANY_REQUESTS"]
          example: TOO_MANY_REQUESTS
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    EmailServiceError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Failed to send the email. Please try again later.
        errorCode:
          type: string
          enum: ["EMAIL_SERVICE_ERROR"]
          example: EMAIL_SERVICE_ERROR
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    InvalidRequestBodyValidationError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
        - errors
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Validation failed, some fields in the request body did not meet the expected format or constraints.
        errorCode:
          type: string
          enum: ["VALIDATION_ERROR_INVALID_REQUEST_BODY"]
          example: VALIDATION_ERROR_INVALID_REQUEST_BODY
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
        errors:
          type: array
          minItems: 1
          items:
            type: object
            required:
              - field
              - message
            properties:
              field:
                type: string
              message:
                type: string
          example:
            - field: email
              message: Invalid email address
            - field: password
              message: Password must be at least 8 characters
    # EMAIL & PASS ERRORS
    EmailAlreadyExistsError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Registration failed, this email address is already associated with an existing account.
        errorCode:
          type: string
          enum: ["AUTH_EMAIL_ALREADY_EXISTS"]
          example: AUTH_EMAIL_ALREADY_EXISTS
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    UserNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: User with the specified email was not found.
        errorCode:
          type: string
          enum: ["AUTH_USER_NOT_FOUND"]
          example: AUTH_USER_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    InvalidCredentialsError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Invalid credentials. Please check your email and password and try again.
        errorCode:
          type: string
          enum: ["AUTH_INVALID_CREDENTIALS"]
          example: AUTH_INVALID_CREDENTIALS
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasswordReuseNotAllowed:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: You cannot reuse a previous password. Please choose a new one.
        errorCode:
          type: string
          enum: ["AUTH_PASSWORD_REUSE_NOT_ALLOWED"]
          example: AUTH_PASSWORD_REUSE_NOT_ALLOWED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # VERFICATION CODES
    VerificationCodeNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Invalid or non-existent verification code. Please request a new one.
        errorCode:
          type: string
          enum: ["VERIFICATION_CODE_ERROR_CODE_NOT_FOUND"]
          example: VERIFICATION_CODE_ERROR_CODE_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    VerificationCodeExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: This verification code has expired. Please request a new one to continue.
        errorCode:
          type: string
          enum: ["VERIFICATION_CODE_ERROR_CODE_EXPIRED"]
          example: VERIFICATION_CODE_ERROR_CODE_EXPIRED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    VerificationCodeConsumedError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: This verification code has already been used. Please request a new one if needed.
        errorCode:
          type: string
          enum: ["VERIFICATION_CODE_ERROR_CODE_CONSUMED"]
          example: VERIFICATION_CODE_ERROR_CODE_CONSUMED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # TOKEN GENERAL ERRORS
    AuthenticationTokenNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, no authentication token provided.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_NOT_FOUND"]
          example: AUTH_TOKEN_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenUserNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the user associated with this token does not exist.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_USER_NOT_FOUND"]
          example: AUTH_TOKEN_USER_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenInvalidSessionError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the token session is invalid, expired, or has already been consumed.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_SESSION_INVALID"]
          example: AUTH_TOKEN_SESSION_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenSessionMismatchError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the user ID in the JWT token does not match the user ID of the session.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_SESSION_MISMATCH"]
          example: AUTH_TOKEN_SESSION_MISMATCH
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenInvalidTokenErorr:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
        message:
          type: string
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_INVALID"]
        requestId:
          type: string
      examples:
        jwtMalformed:
          summary: Token is malformed
          value:
            success: false
            message: "Authentication failed: jwt malformed"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
        invalidSignature:
          summary: Token signature is invalid
          value:
            success: false
            message: "Authentication failed: invalid signature"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
        tokenMissing:
          summary: Token is missing
          value:
            success: false
            message: "Authentication failed: jwt must be provided"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
        invalidAudience:
          summary: Token audience does not match
          value:
            success: false
            message: "Authentication failed: invalid audience"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
        invalidIssuer:
          summary: Token issuer is invalid
          value:
            success: false
            message: "Authentication failed: invalid issuer"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, jwt expired at 2025-11-02T18:00:00Z.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_EXPIRED"]
          example: AUTH_TOKEN_EXPIRED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # ACCESS TOKEN
    AccessTokenTypeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, expected an ACCESS token, but received a token of a different type.
        errorCode:
          type: string
          enum: ["AUTH_ACCESS_TOKEN_TYPE_INVALID"]
          example: AUTH_ACCESS_TOKEN_TYPE_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # MFA TOKEN
    MFATokenTypeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, expected an MFA token, but received a token of a different type.
        errorCode:
          type: string
          enum: ["AUTH_MFA_TOKEN_TYPE_INVALID"]
          example: AUTH_MFA_TOKEN_TYPE_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MFATokenInvalidEndpointError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, MFA token was sent to an invalid or unsupported endpoint.
        errorCode:
          type: string
          enum: ["AUTH_MFA_INVALID_ENDPOINT"]
          example: AUTH_MFA_INVALID_ENDPOINT
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MFATokenInvalidTokenPurposeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, MFA token purpose mismatch. Expected 'login', got 'forgot_password'.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_INVALID_TYPE"]
          example: AUTH_TOKEN_INVALID_TYPE
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MFAForbiddenError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: You do not have permission to perform this action. To benefit of 2FA, please add a password-based login method in your account settings first. (choose forgot password).
        errorCode:
          type: string
          enum: ["ACCESS_FORBIDDEN"]
          example: ACCESS_FORBIDDEN
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # MAGIC LINK TOKEN
    MagicLinkTokenTypeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, expected an MAGIC-LINK token, but received a token of a different type.
        errorCode:
          type: string
          enum: ["AUTH_MAGIC_LINK_TOKEN_TYPE_INVALID"]
          example: AUTH_MAGIC_LINK_TOKEN_TYPE_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # REFRESH TOKEN
    RefreshTokenTypeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, expected an REFRESH token, but received a token of a different type.
        errorCode:
          type: string
          enum: ["AUTH_REFRESH_TOKEN_TYPE_INVALID"]
          example: AUTH_REFRESH_TOKEN_TYPE_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    RefreshTokenInvalidSessionError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the refresh token session does not exist or is invalid. Please log in again.
        errorCode:
          type: string
          enum: ["AUTH_REFRESH_TOKEN_SESSION_INVALID"]
          example: AUTH_REFRESH_TOKEN_SESSION_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    RefreshTokenExpiredSessionError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the refresh token session has expired. Please log in again to obtain a new refresh token.
        errorCode:
          type: string
          enum: ["AUTH_REFRESH_TOKEN_SESSION_EXPIRED"]
          example: AUTH_REFRESH_TOKEN_SESSION_EXPIRED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # MFA
    MfaAlreadyEnabledError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Two-factor authentication is already enabled. No further action is required.
        errorCode:
          type: string
          enum: ["MFA_ALREADY_ENABLED"]
          example: MFA_ALREADY_ENABLED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MfaAlreadyDisabledError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Two-factor authentication is already disabled. No further action is required.
        errorCode:
          type: string
          enum: ["MFA_ALREADY_DISABLED"]
          example: MFA_ALREADY_DISABLED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MfaTemporarySecretExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Temporary TOTP secret expired. Please generate a new QR code to configure 2FA.
        errorCode:
          type: string
          enum: ["MFA_EXPIRED_TEMP_SECRET"]
          example: MFA_EXPIRED_TEMP_SECRET
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MfaInvalidVerificationCodeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: The MFA code you entered is incorrect or has expired. Please request a new code to complete the verification.
        errorCode:
          type: string
          enum: ["MFA_INVALID_VERIFICATION_CODE"]
          example: MFA_INVALID_VERIFICATION_CODE
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MfaNotEnabledError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Cannot verify MFA because two-factor authentication is not enabled for this account.
        errorCode:
          type: string
          enum: ["MFA_NOT_ENABLED"]
          example: MFA_NOT_ENABLED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    InvalidBackupCodeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: The backup code you entered is invalid or has already been used. Please try a different one.
        errorCode:
          type: string
          enum: ["BACKUPCODE_INVALID_CODE"]
          example: BACKUPCODE_INVALID_CODE
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # OIDC
    OIDCSessionNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, no valid OIDC session was found for the given state and provider.
        errorCode:
          type: string
          enum: ["OIDC_SESSION_NOT_FOUND"]
          example: OIDC_SESSION_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    OIDCSessionExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the OIDC session has expired. Please restart the sign-in process.
        errorCode:
          type: string
          enum: ["OIDC_SESSION_CONSUMED"]
          example: OIDC_SESSION_CONSUMED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    OIDCSessionConsumedError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the OIDC session has already been used and cannot be reused.
        errorCode:
          type: string
          enum: ["OIDC_SESSION_CONSUMED"]
          example: OIDC_SESSION_CONSUMED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    OIDCFailedAuthenticationError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed while communicating with the external identity provider. Please try again or use a different sign-in method.
        errorCode:
          type: string
          enum: ["OIDC_FAILED_AUTHENTIFICATION"]
          example: OIDC_FAILED_AUTHENTIFICATION
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # PASSKEY
    PasskeyChallengeSessionNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey registration session was not found or is invalid. Please restart the passkey process.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALLENGE_SESSION_INVALID"]
          example: PASSKEY_CHALLENGE_SESSION_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionConsumedError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey session has already been used. Please restart the passkey process.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALLENGE_SESSION_CONSUMED"]
          example: PASSKEY_CHALLENGE_SESSION_CONSUMED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionInvalidPurposeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey session purpose does not match the expected type. Please restart the passkey process.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALLENGE_SESSION__INVALID_PURPOSE"]
          example: PASSKEY_CHALLENGE_SESSION__INVALID_PURPOSE
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey session has expired. Please restart the passkey process.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALLENGE_SESSION__EXPIRED"]
          example: PASSKEY_CHALLENGE_SESSION__EXPIRED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeVerificationError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey verification could not be completed successfully. Please ensure you are using the correct passkey and try again.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALENGE_VERIFICATION_ERROR"]
          example: PASSKEY_CHALENGE_VERIFICATION_ERROR
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the provided passkey could not be found or is invalid. Please remove this passkey from your device and register a new one.
        errorCode:
          type: string
          enum: ["PASSKEY_NOT_FOUND"]
          example: PASSKEY_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # SESSIONS
    UserSessionNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: The session associated with this operation could not be found.
        errorCode:
          type: string
          enum: ["AUTH_SESSION_NOT_FOUND"]
          example: AUTH_SESSION_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
  # EXAMPLES
  examples:
    # SUCCESS RESPONSES
    LoginEmailVerificationPendingResponseExample:
      summary: Login pending due to unverified email
      value:
        success: true
        statusCode: 200
        message: Authentication pending, your email address has not yet been verified. Please confirm your email to proceed.
        data:
          nextStep: CONFIRM_SIGN_UP
        metadata:
          requestId: 627c83c6ac314a94bd9348d78
          timestamp: 2025-10-31T18:08:35.135Z
    LoginSuccessResponseExample:
      summary: Login successful without MFA
      value:
        success: true
        statusCode: 200
        message: Authentication successful, You have been signed in successfully.
        data:
          user:
            _id: 6904fb216bdaf225b3726294
            name: user
            email: marinescua914@gmail.com
            isEmailVerified: true
            userPreferences:
              enable2FA: false
              emailNotification: true
            createdAt: 2025-10-31T18:08:33.919Z
            updatedAt: 2025-10-31T18:08:33.919Z
          nextStep: OK
          mfaRequired: false
        metadata:
          requestId: 627c83c6ac314a94bd9348d78
          timestamp: 2025-10-31T18:08:35.135Z
    MFAPendingResponseExample:
      summary: Login pending requiring MFA
      value:
        success: true
        statusCode: 200
        message: Two-factor authentication required. Please enter your verification code to complete this process.
        data:
          nextStep: MFA_REQUIRED
          mfaRequired: true
        metadata:
          requestId: 627c83c6ac314a94bd9348d78
          timestamp: 2025-10-31T18:08:35.135Z
    ForgotPasswordSuccessResponseExample:
      summary: Password reset request successfully processed
      value:
        success: true
        statusCode: 200
        message: Password reset request successfully processed. Please check your email for further instructions.
        data:
          nextStep: OK
          mfaRequired: false
        metadata:
          requestId: 627c83c6ac314a94bd9348d78
          timestamp: 2025-10-31T18:08:35.135Z
    # ERRORS
    # GENERAL ERRORS
    InternalServerErrorExample:
      summary: Internal server error
      value:
        success: false
        message: Internal Server Error
        errorCode: INTERNAL_SERVER_ERROR
        requestId: cc5065df0c6b4c19970d4e92f
    ForbiddenErrorExample:
      summary: Access forbidden
      value:
        success: false
        message: Access denied, you do not have permission to perform this action.
        errorCode: ACCESS_FORBIDDEN
        requestId: cc5065df0c6b4c19970d4e92f
    TooManyRequestsErrorExample:
      summary: Too many requests
      value:
        success: false
        message: Too many requests. Please try again later.
        errorCode: TOO_MANY_REQUESTS
        requestId: cc5065df0c6b4c19970d4e92f
    EmailServiceErrorExample:
      summary: Email service failure
      value:
        success: false
        message: Failed to send the email. Please try again later.
        errorCode: EMAIL_SERVICE_ERROR
        requestId: cc5065df0c6b4c19970d4e92f
    InvalidRequestBodyValidationErrorExample:
      summary: Invalid request body
      value:
        success: false
        message: Validation failed, some fields in the request body did not meet the expected format or constraints.
        errorCode: VALIDATION_ERROR_INVALID_REQUEST_BODY
        requestId: cc5065df0c6b4c19970d4e92f
        errors:
          - field: email
            message: Invalid email address
          - field: password
            message: Password must be at least 8 characters
    # EMAIL & PASS ERRORS
    EmailAlreadyExistsErrorExample:
      summary: Email already exists
      value:
        success: false
        message: Registration failed, this email address is already associated with an existing account.
        errorCode: AUTH_EMAIL_ALREADY_EXISTS
        requestId: cc5065df0c6b4c19970d4e92f
    UserNotFoundErrorExample:
      summary: User not found
      value:
        success: false
        message: User with the specified email was not found.
        errorCode: AUTH_USER_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    InvalidCredentialsErrorExample:
      summary: Invalid credentials
      value:
        success: false
        message: Invalid credentials. Please check your email and password and try again.
        errorCode: AUTH_INVALID_CREDENTIALS
        requestId: cc5065df0c6b4c19970d4e92f
    PasswordReuseNotAllowedExample:
      summary: Password reuse not allowed
      value:
        success: false
        message: You cannot reuse a previous password. Please choose a new one.
        errorCode: AUTH_PASSWORD_REUSE_NOT_ALLOWED
        requestId: cc5065df0c6b4c19970d4e92f
    # VERFICATION CODES
    VerificationCodeNotFoundErrorExample:
      summary: Verification code not found
      value:
        success: false
        message: Invalid or non-existent verification code. Please request a new one.
        errorCode: VERIFICATION_CODE_ERROR_CODE_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    VerificationCodeExpiredErrorExample:
      summary: Verification code expired
      value:
        success: false
        message: This verification code has expired. Please request a new one to continue.
        errorCode: VERIFICATION_CODE_ERROR_CODE_EXPIRED
        requestId: cc5065df0c6b4c19970d4e92f
    VerificationCodeConsumedErrorExample:
      summary: Verification code already consumed
      value:
        success: false
        message: This verification code has already been used. Please request a new one if needed.
        errorCode: VERIFICATION_CODE_ERROR_CODE_CONSUMED
        requestId: cc5065df0c6b4c19970d4e92f
    # TOKEN GENERAL ERRORS
    AuthenticationTokenNotFoundErrorExample:
      summary: Authentication token not found
      value:
        success: false
        message: Authentication failed, no authentication token provided.
        errorCode: AUTH_TOKEN_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenUserNotFoundErrorExample:
      summary: User associated with token not found
      value:
        success: false
        message: Authentication failed, the user associated with this token does not exist.
        errorCode: AUTH_TOKEN_USER_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenInvalidSessionErrorExample:
      summary: Invalid token session
      value:
        success: false
        message: Authentication failed, the token session is invalid, expired, or has already been consumed.
        errorCode: AUTH_TOKEN_SESSION_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenSessionMismatchErrorExample:
      summary: Token session mismatch
      value:
        success: false
        message: Authentication failed, the user ID in the JWT token does not match the user ID of the session.
        errorCode: AUTH_TOKEN_SESSION_MISMATCH
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenExpiredErrorExample:
      summary: Token expired
      value:
        success: false
        message: Authentication failed, jwt expired at 2025-11-02T18:00:00Z.
        errorCode: AUTH_TOKEN_EXPIRED
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenInvalidErrorExample:
      summary: Invalid token
      value:
        success: false
        message: >
          Authentication failed. Possible reasons:
          - jwt malformed
          - invalid signature
          - jwt must be provided
          - invalid audience
          - invalid issuer
        errorCode: AUTH_TOKEN_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    # ACCESS
    AccessTokenTypeErrorExample:
      summary: Invalid access token type
      value:
        success: false
        message: Authentication failed, expected an ACCESS token, but received a token of a different type.
        errorCode: AUTH_ACCESS_TOKEN_TYPE_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    # MFA TOKEN
    MFATokenTypeErrorExample:
      summary: Invalid MFA token type
      value:
        success: false
        message: Authentication failed, expected an MFA token, but received a token of a different type.
        errorCode: AUTH_MFA_TOKEN_TYPE_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    MFATokenInvalidEndpointErrorExample:
      summary: MFA token sent to invalid endpoint
      value:
        success: false
        message: Authentication failed, MFA token was sent to an invalid or unsupported endpoint.
        errorCode: AUTH_MFA_INVALID_ENDPOINT
        requestId: cc5065df0c6b4c19970d4e92f
    MFATokenInvalidTokenPurposeErrorExample:
      summary: MFA token purpose mismatch
      value:
        success: false
        message: Authentication failed, MFA token purpose mismatch. Expected 'login', got 'forgot_password'.
        errorCode: AUTH_TOKEN_INVALID_TYPE
        requestId: cc5065df0c6b4c19970d4e92f
    # MAGIC LINK TOKEN
    MagicLinkTokenTypeErrorExample:
      summary: Invalid magic link token type
      value:
        success: false
        message: Authentication failed, expected an MAGIC-LINK token, but received a token of a different type.
        errorCode: AUTH_MAGIC_LINK_TOKEN_TYPE_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    # REFRESH TOKEN
    RefreshTokenTypeErrorExample:
      summary: Invalid refresh token type
      value:
        success: false
        message: Authentication failed, expected an REFRESH token, but received a token of a different type.
        errorCode: AUTH_REFRESH_TOKEN_TYPE_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    RefreshTokenInvalidSessionErrorExample:
      summary: Refresh token session invalid
      value:
        success: false
        message: Authentication failed, the refresh token session does not exist or is invalid. Please log in again.
        errorCode: AUTH_REFRESH_TOKEN_SESSION_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    RefreshTokenExpiredSessionErrorExample:
      summary: Refresh token session expired
      value:
        success: false
        message: Authentication failed, the refresh token session has expired. Please log in again to obtain a new refresh token.
        errorCode: AUTH_REFRESH_TOKEN_SESSION_EXPIRED
        requestId: cc5065df0c6b4c19970d4e92f
    # MFA
    MfaAlreadyEnabledErrorExample:
      summary: MFA already enabled
      value:
        success: false
        message: Two-factor authentication is already enabled. No further action is required.
        errorCode: MFA_ALREADY_ENABLED
        requestId: cc5065df0c6b4c19970d4e92f
    MfaAlreadyDisabledErrorExample:
      summary: MFA already disabled
      value:
        success: false
        message: Two-factor authentication is already disabled. No further action is required.
        errorCode: MFA_ALREADY_DISABLED
        requestId: cc5065df0c6b4c19970d4e92f
    MfaTemporarySecretExpiredErrorExample:
      summary: Temporary TOTP secret expired
      value:
        success: false
        message: Temporary TOTP secret expired. Please generate a new QR code to configure 2FA.
        errorCode: MFA_EXPIRED_TEMP_SECRET
        requestId: cc5065df0c6b4c19970d4e92f
    MfaInvalidVerificationCodeErrorExample:
      summary: Invalid or expired MFA code
      value:
        success: false
        message: The MFA code you entered is incorrect or has expired. Please request a new code to complete the verification.
        errorCode: MFA_INVALID_VERIFICATION_CODE
        requestId: cc5065df0c6b4c19970d4e92f
    MfaNotEnabledErrorExample:
      summary: MFA not enabled
      value:
        success: false
        message: Cannot verify MFA because two-factor authentication is not enabled for this account.
        errorCode: MFA_NOT_ENABLED
        requestId: cc5065df0c6b4c19970d4e92f
    InvalidBackupCodeErrorExample:
      summary: Invalid or already used backup code
      value:
        success: false
        message: The backup code you entered is invalid or has already been used. Please try a different one.
        errorCode: BACKUPCODE_INVALID_CODE
        requestId: cc5065df0c6b4c19970d4e92f
    MFAForbiddenErrorExample:
      summary: User cannot perform MFA action due to missing password-based login
      value:
        success: false
        message: "You do not have permission to perform this action. To benefit of 2FA, please add a password-based login method in your account settings first. (choose forgot password)."
        errorCode: ACCESS_FORBIDDEN
        requestId: cc5065df0c6b4c19970d4e92f
    # OIDC
    OIDCSessionNotFoundErrorExample:
      summary: OIDC session not found
      value:
        success: false
        message: Authentication failed, no valid OIDC session was found for the given state and provider.
        errorCode: OIDC_SESSION_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    OIDCSessionExpiredErrorExample:
      summary: OIDC session expired
      value:
        success: false
        message: Authentication failed, the OIDC session has expired. Please restart the sign-in process.
        errorCode: OIDC_SESSION_CONSUMED
        requestId: cc5065df0c6b4c19970d4e92f
    OIDCSessionConsumedErrorExample:
      summary: OIDC session already used
      value:
        success: false
        message: Authentication failed, the OIDC session has already been used and cannot be reused.
        errorCode: OIDC_SESSION_CONSUMED
        requestId: cc5065df0c6b4c19970d4e92f
    OIDCFailedAuthenticationErrorExample:
      summary: OIDC failed authentication
      value:
        success: false
        message: Authentication failed while communicating with the external identity provider. Please try again or use a different sign-in method.
        errorCode: OIDC_FAILED_AUTHENTIFICATION
        requestId: cc5065df0c6b4c19970d4e92f
    # PASSKEY
    PasskeyChallengeSessionNotFoundErrorExample:
      summary: Passkey challenge session not found
      value:
        success: false
        message: Authentication failed, the passkey registration session was not found or is invalid. Please restart the passkey process.
        errorCode: PASSKEY_CHALLENGE_SESSION_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionConsumedErrorExample:
      summary: Passkey challenge session already used
      value:
        success: false
        message: Authentication failed, the passkey session has already been used. Please restart the passkey process.
        errorCode: PASSKEY_CHALLENGE_SESSION_CONSUMED
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionInvalidPurposeErrorExample:
      summary: Passkey challenge session purpose invalid
      value:
        success: false
        message: Authentication failed, the passkey session purpose does not match the expected type. Please restart the passkey process.
        errorCode: PASSKEY_CHALLENGE_SESSION__INVALID_PURPOSE
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionExpiredErrorExample:
      summary: Passkey challenge session expired
      value:
        success: false
        message: Authentication failed, the passkey session has expired. Please restart the passkey process.
        errorCode: PASSKEY_CHALLENGE_SESSION__EXPIRED
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeVerificationErrorExample:
      summary: Passkey verification failed
      value:
        success: false
        message: Authentication failed, the passkey verification could not be completed successfully. Please ensure you are using the correct passkey and try again.
        errorCode: PASSKEY_CHALENGE_VERIFICATION_ERROR
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyNotFoundErrorExample:
      summary: Passkey not found
      value:
        success: false
        message: Authentication failed, the provided passkey could not be found or is invalid. Please remove this passkey from your device and register a new one.
        errorCode: PASSKEY_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    #SESSIONS
    UserSessionNotFoundErrorExample:
      summary: User session not found
      value:
        success: false
        message: The session associated with this operation could not be found.
        errorCode: AUTH_SESSION_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
  # HEADERS
  headers:
    XRequestId:
      description: Unique request identifier for tracing and debugging
      schema:
        type: string
      examples:
        default:
          value: "627c83c6ac314a94bd9348d78"
    AuthenticationCookies:
      description: |
        Multiple cookies may be set in this response:
        1. accessToken â€” HTTP-only access token
        2. refreshToken â€” HTTP-only refresh token
        3. mfaToken â€” HTTP-only MFA token (if required)
      schema:
        type: string
      examples:
        default:
          value: |
            accessToken=eyJhbGciOi...; Path=/; HttpOnly; Secure; SameSite=Strict; Expires=Wed, 03 Nov 2025 20:00:00 GMT,
            refreshToken=eyJhbGciOi...; Path=/auth/refresh; HttpOnly; Secure; SameSite=Strict; Expires=Wed, 03 Nov 2025 20:00:00 GMT
            mfaToken=eyJhbGciOi...; Path=/mfa; HttpOnly; Secure; SameSite=Strict; Expires=Wed, 03 Nov 2025 20:00:00 GMT
    MFATokenCookie:
      description: |
        HTTP-only MFA token cookie used for two-factor authentication.
        This cookie must be included in subsequent requests to complete the MFA step.
      schema:
        type: string
      examples:
        default:
          value: |
            mfaToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...; Path=/mfa; HttpOnly; Secure; SameSite=Strict; Expires=Wed, 03 Nov 2025 20:00:00 GMT
    InvalidateAuthenticationCookies:
      description: |
        Multiple authentication cookies may be cleared in this response to invalidate any existing sessions.
        This ensures that previously issued tokens become unusable and the user must log in again.
        The following cookies are invalidated:
        1. accessToken â€” HTTP-only access token
        2. refreshToken â€” HTTP-only refresh token
      schema:
        type: string
      examples:
        default:
          value: |
            accessToken=; Path=/; HttpOnly; Secure; SameSite=Strict; Expires=Thu, 01 Jan 1970 00:00:00 GMT
            refreshToken=; Path=/auth/refresh; HttpOnly; Secure; SameSite=Strict; Expires=Thu, 01 Jan 1970 00:00:00 GMT
  # SECURITY
  securitySchemes:
    AccessTokenCokie:
      type: apiKey
      in: cookie
      name: accessToken
    RefreshTokenCokie:
      type: apiKey
      in: cookie
      name: accessToken
    MfaTokenCokie:
      type: apiKey
      in: cookie
      name: mfaToken
