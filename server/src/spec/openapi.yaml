openapi: 3.1.0
info:
  title: API for Password, Passkey, Magic Link, and OIDC Authentication
  description: >
    API for user registration and authentication using multiple methods:
    username/password with capability of 2fa, passkey (WebAuthn), magic link, and OIDC providers (Google, GitHub, etc.).
  contact:
    name: Marinescu Alexandru
    email: amarinescu.dev@gmail.com
  license:
    name: Apache License 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0
  version: 1.0.0
servers:
  - url: https://accounts.authportal.com/api/v1
    description: Production Server
paths:
  /auth/register:
    post:
      tags: [Email & Password Auth]
      summary: Register a new user
      description: This endpoint allows a new user to create an account using their email and password. After registration, the user must verify their email to complete the registration process successfully.
      requestBody:
        required: true
        description: Request body for user registration.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserRegistrationRequestBody"
      responses:
        "201":
          description: Registration successful. A verification email has been sent, the user must confirm their email to complete the signup process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegistrationSuccessReponse"
        "400":
          description: Bad Request â€” validation failed or user already exists.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                EmailAlreadyExistsError:
                  $ref: "#/components/examples/EmailAlreadyExistsErrorExample"
                InvalidRequestBodyValidationError:
                  $ref: "#/components/examples/InvalidRequestBodyValidationErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/EmailAlreadyExistsError"
                  - $ref: "#/components/schemas/InvalidRequestBodyValidationError"
  /auth/login:
    post:
      tags: [Email & Password Auth]
      summary: Authenticate a user with email and password
      description: >
        This endpoint allows an existing user to log in using their email and password.
        Upon successful authentication, an access token (and optionally a refresh token) is returned.
        If the user has two-factor authentication enabled, additional steps may be required to complete the login process.
      requestBody:
        required: true
        description: Credentials for user login
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserLoginRequestBody"
      responses:
        "200":
          description: >
            Authentication response. Depending on the user's status, one of the following outcomes is returned:
            1. Email not verified â€” user must confirm their email to proceed.
            2. Two-factor authentication required â€” user must complete MFA to finalize login.
            3. Authentication successful â€” user credentials are valid, and access/refresh tokens are provided.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              examples:
                LoginEmailVerificationPendingResponse:
                  $ref: "#/components/examples/LoginEmailVerificationPendingResponseExample"
                MFAPendingResponse:
                  $ref: "#/components/examples/MFAPendingResponseExample"
                LoginSuccessResponse:
                  $ref: "#/components/examples/LoginSuccessResponseExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/LoginEmailVerificationPendingResponse"
                  - $ref: "#/components/schemas/MFAPendingResponse"
                  - $ref: "#/components/schemas/LoginSuccessResponse"
        "404":
          description: >
            User not found â€” no account exists with the provided email address. 
            The client should prompt the user to register before attempting login.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        "400":
          description: >
            Invalid credentials â€” the provided email or password is incorrect. 
            The client should notify the user and allow them to retry authentication.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidCredentialsError"
  /auth/email/verify:
    post:
      tags: [Email & Password Auth]
      summary: Authenticate a user with email and password
      description: >
        Verifies a user's email address using a verification token sent via email.
        Upon successful verification, the user's account is marked as confirmed, allowing them to complete the login process or other protected actions.
      requestBody:
        required: true
        description: Verify a user's email address
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              properties:
                code:
                  type: string
                  example: n3910310n013912310sa
      responses:
        "200":
          description: >
            Email verification successful. The user's email address has been confirmed, enabling them to complete the login process and access protected resources.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailConfirmedSuccessResponse"
        "404":
          description: >
            Verification failed, the provided verification code was not found.
            This may happen if the code is invalid or never issued. The user should request a new verification code.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/VerificationCodeNotFoundError"
        "400":
          description: >
            Verification failed due to an invalid verification code state:
            1. The code has expired â€” the user must request a new verification code.
            2. The code has already been consumed â€” the user must request a new verification code.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                VerificationCodeExpiredError:
                  $ref: "#/components/examples/VerificationCodeExpiredErrorExample"
                VerificationCodeConsumedError:
                  $ref: "#/components/examples/VerificationCodeConsumedErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/VerificationCodeExpiredError"
                  - $ref: "#/components/schemas/VerificationCodeConsumedError"
  /auth/password/forgot:
    post:
      tags: [Email & Password Auth]
      summary: Request a password reset for a user account
      description: >
        Initiates the password reset process for a user by submitting their email address. 
        If the user has two-factor authentication (MFA) enabled, an MFA verification step will be required before sending the password reset instructions. Otherwise, a password reset email will be sent directly.
      requestBody:
        required: true
        description: Email address of the user requesting a password reset
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordRequestBody"
      responses:
        "200":
          description: >
            Password reset request processed successfully. Depending on the user's account configuration:
            1. MFA pending â€” if the user has two-factor authentication enabled, an MFA verification step is required before sending the reset email.
            2. Reset email sent â€” if MFA is not enabled, a password reset email has been sent with instructions to reset the password.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/MFATokenCookie"
          content:
            application/json:
              examples:
                MFAPendingResponse:
                  $ref: "#/components/examples/MFAPendingResponseExample"
                ForgotPasswordSuccessResponse:
                  $ref: "#/components/examples/ForgotPasswordSuccessResponseExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/MFAPendingResponse"
                  - $ref: "#/components/schemas/ForgotPasswordSuccessResponse"
        "404":
          description: >
            User not found â€” no account exists for the provided email address. Ensure the email is correct and try again.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        "503":
          description: >
            Email service unavailable â€” the system could not send the password reset email due to a temporary email service failure. Retry the request later.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /auth/password/reset:
    patch:
      tags: [Email & Password Auth]
      summary: Complete the password reset process
      description: >
        Completes the password reset process for a user account using a valid verification code.  
        The request must include the verification code (typically received via email) and the new password.  
        Upon successful verification, the user's password is updated, existing authentication cookies are cleared,  
        and the user is advised to log in again. If the password reset was not initiated by the user, they are encouraged  
        to contact support immediately. The operation also records contextual information such as IP address and user agent  
        for security auditing purposes.
      requestBody:
        required: true
        description: x
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordRequestBody"
      responses:
        "200":
          description: >
            Password reset completed successfully.  
            All existing authentication cookies are invalidated to ensure previous sessions are closed.  
            The user should proceed to log in with the new password.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/InvalidateAuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResetPasswordSuccessResponse"
        "404":
          description: >
            The provided verification code or associated user could not be found.  
            This may occur if the code is invalid or the user no longer exists in the system.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                VerificationCodeNotFoundError:
                  $ref: "#/components/examples/VerificationCodeNotFoundErrorExample"
                UserNotFoundError:
                  $ref: "#/components/examples/UserNotFoundErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/VerificationCodeNotFoundError"
                  - $ref: "#/components/schemas/UserNotFoundError"
        "400":
          description: >
            The password reset request could not be completed due to invalid or expired data.  
            Possible causes include:
            - The verification code has expired or was already consumed.  
            - The new password does not meet security requirements or was previously used.  
            The client should prompt the user to request a new password reset code and try again.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                VerificationCodeExpiredError:
                  $ref: "#/components/examples/VerificationCodeExpiredErrorExample"
                VerificationCodeConsumedError:
                  $ref: "#/components/examples/VerificationCodeConsumedErrorExample"
                PasswordReuseNotAllowed:
                  $ref: "#/components/examples/PasswordReuseNotAllowedExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/VerificationCodeExpiredError"
                  - $ref: "#/components/schemas/VerificationCodeConsumedError"
                  - $ref: "#/components/schemas/PasswordReuseNotAllowed"
  /auth/refresh:
    get:
      security:
        - RefreshTokenCokie: []
      tags: [Email & Password Auth]
      summary: Refresh the user's access token using a valid refresh token
      description: >
        Issues a new access token (and optionally a new refresh token) for an authenticated session.  
        The request must include a valid **refresh token** stored in the user's HTTP-only cookie. If the refresh token is valid and the session is still active, a new access token will be returned and authentication cookies will be updated.  
        If the refresh token is expired, invalid, or mismatched, the session will be invalidated and all authentication cookies will be cleared to enforce re-authentication.  
        This endpoint ensures seamless session continuity while maintaining security best practices.
      responses:
        "200":
          description: >
            Access token successfully refreshed.  
            The user's session remains active, and new authentication cookies are set.  
            If a new refresh token was issued, it replaces the previous one automatically.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefreshTokenEndpointSuccessResponse"
        "401":
          description: >
            The refresh token is invalid, expired, missing, or does not match the current session.  
            All authentication cookies are invalidated to prevent unauthorized access,  
            and the user must log in again to obtain a new session.  
            This response covers multiple possible authentication-related errors such as invalid token type, missing cookie, or user/session mismatch.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/InvalidateAuthenticationCookies"
          content:
            application/json:
              examples:
                RefreshTokenInvalidSessionError:
                  $ref: "#/components/examples/RefreshTokenInvalidSessionErrorExample"
                AuthenticationTokenNotFoundError:
                  $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
                RefreshTokenTypeError:
                  $ref: "#/components/examples/RefreshTokenTypeErrorExample"
                AuthenticationTokenUserNotFoundError:
                  $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
                RefreshTokenExpiredSessionError:
                  $ref: "#/components/examples/RefreshTokenExpiredSessionErrorExample"
                AuthenticationTokenSessionMismatchError:
                  $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
                AuthenticationTokenInvalidErorr:
                  $ref: "#/components/examples/AuthenticationTokenInvalidErrorExample"
                AuthenticationTokenExpiredError:
                  $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/RefreshTokenInvalidSessionError"
                  - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
                  - $ref: "#/components/schemas/RefreshTokenTypeError"
                  - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
                  - $ref: "#/components/schemas/RefreshTokenExpiredSessionError"
                  - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
                  - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
  /auth/logout:
    post:
      security:
        - AccessTokenCokie: []
      tags: [Email & Password Auth]
      summary: Log out the authenticated user and invalidate the current session
      description: >
        Terminates the current authenticated session by invalidating all active authentication tokens and clearing related cookies (`accessToken`, `refreshToken`).  
        This ensures that both the access token and any linked refresh token can no longer be used.  
        The endpoint is typically called when a user explicitly logs out or when a session needs to be forcefully closed for security reasons.  
        Requires a valid access token cookie for authentication and session validation.  
        After a successful logout, the client should remove any cached session state and redirect the user to a login page.
      responses:
        "200":
          description: >
            User successfully logged out.  
            All authentication cookies have been invalidated and removed to ensure session termination.  
            The client should prompt the user to log in again if further access is required.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/InvalidateAuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LogoutSuccessResponse"
        "401":
          description: >
            The logout request could not be completed because the provided access token is missing, expired, invalid, or does not correspond to an active user session.  
            In this case, the server cannot confirm the logout and does not modify authentication cookies.  
            The client should treat the user as unauthenticated and clear any local session data.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                AuthenticationTokenNotFoundError:
                  $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
                AccessTokenTypeError:
                  $ref: "#/components/examples/AccessTokenTypeErrorExample"
                AuthenticationTokenUserNotFoundError:
                  $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
                AuthenticationTokenInvalidSessionError:
                  $ref: "#/components/examples/AuthenticationTokenInvalidSessionErrorExample"
                AuthenticationTokenSessionMismatchError:
                  $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
                AuthenticationTokenInvalidError:
                  $ref: "#/components/examples/AuthenticationTokenInvalidErrorExample"
                AuthenticationTokenExpiredError:
                  $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
                  - $ref: "#/components/schemas/AccessTokenTypeError"
                  - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidSessionError"
                  - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
                  - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
  /magic-link/signup:
    post:
      tags: [âœ¨ Magic-Link Authentication]
      summary: Register a new user using a magic link
      description: |
        Registers a new user account by sending a **magic link** to the provided email address. 
        The user can complete the signup process by clicking the link in the verification email. 
        If the email is already associated with an existing account, the request will be rejected.  
        This flow is typically used when passwordless authentication is enabled for the application.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MagicLinkSignUpRequestBody"
      responses:
        "200":
          description: |
            Signup request successful â€” a magic link has been sent to the provided email address.
            The user must click the link to verify their email and activate their account.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MagicLinkSignUpSuccessResponse"
        "401":
          description: |
            Unauthorized â€” the email address is already registered or cannot be used for signup.
            The client should not attempt to resend the signup link for the same email.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailAlreadyExistsError"
        "503":
          description: |
            Service Unavailable â€” the email delivery service is temporarily unavailable or failed 
            to send the verification link. The client may retry after a short delay.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /magic-link/signin:
    post:
      tags: [âœ¨ Magic-Link Authentication]
      summary: Sign in a user using a magic link
      description: |
        Initiates a passwordless sign-in flow by sending a magic link to the user email address. 
        The user can authenticate by clicking the link received in their inbox. 
        If the email is not associated with any account, the request will fail with a 404 response. 
        This endpoint is typically used in passwordless authentication systems.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MagicLinkSignInRequestBody"
      responses:
        "200":
          description: |
            Magic link successfully sent to the user's email address. 
            The user must click the link to complete authentication.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MagicLinkSignInSuccessResponse"
        "404":
          description: |
            Not Found. The specified email address does not match any registered user account. 
            The client should prompt the user to register or verify their email.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        "503":
          description: |
            Service Unavailable. The email delivery service is temporarily unavailable 
            or failed to send the magic link. The client may retry after a short delay.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /magic-link/resend:
    post:
      tags: [âœ¨ Magic-Link Authentication]
      summary: Resend a magic link for email verification or sign-in
      description: |
        Resends a new generated magic link to the user's email address. 
        This endpoint can be used when the user did not receive or accidentally deleted 
        the original magic link for verification or sign-in. 
        If the email does not correspond to an existing user, the request will fail with a 404 response. 
        This operation is commonly used in passwordless authentication systems to handle failed or lost verification emails.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MagicLinkSignInRequestBody"
      responses:
        "200":
          description: |
            Magic link successfully sent to the user's email address.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MagicLinkSignInSuccessResponse"
        "404":
          description: |
            Not Found. The specified email address does not match any registered user account. 
            The client should prompt the user to register or verify their email.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotFoundError"
        "503":
          description: |
            Service Unavailable. The email delivery service is temporarily unavailable 
            or failed to send the magic link. The client may retry after a short delay.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailServiceError"
  /magic-link/verify/{token}:
    get:
      tags: [âœ¨ Magic-Link Authentication]
      summary: Verify a user's email using a magic link token
      description: |
        Verifies a user's email or signs them in by validating the provided magic link token. 
        This endpoint is typically triggered when the user clicks on the magic link sent to their email. 
        Upon successful verification, authentication cookies or tokens are issued to establish the session.
      parameters:
        - name: token
          in: path
          required: true
          description: >
            A unique, single-use token included in the magic link sent to the user's email. 
            It is used to verify the user's email ownership and complete the sign-in process.
          schema:
            type: string
      responses:
        "200":
          description: |
            Magic link verified successfully. The user's email has been confirmed (for signup verification) 
            or the user has been signed in (for passwordless authentication). 
            Authentication cookies or tokens are issued in the response headers to establish the session.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
            Set-Cookie:
              $ref: "#/components/headers/AuthenticationCookies"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginSuccessResponse"
        "401":
          description: |
            Unauthorized. The provided magic link token is invalid, expired, or cannot be used to authenticate the user. 
            Possible reasons include:
            - The token was not found in the system (AuthenticationTokenNotFound).
            - The token type is incorrect (MagicLinkTokenTypeError).
            - The token does not belong to a valid user (AuthenticationTokenUserNotFoundError).
            - The user's session is invalid or expired (AuthenticationTokenInvalidSessionError).
            - The token does not match the current session (AuthenticationTokenSessionMismatchError).
            - The token is malformed or otherwise invalid (AuthenticationTokenInvalidTokenError).
            - The token has already expired (AuthenticationTokenExpiredError).
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                AuthenticationTokenNotFound:
                  $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
                MagicLinkTokenType:
                  $ref: "#/components/examples/MagicLinkTokenTypeErrorExample"
                AuthenticationTokenUserNotFound:
                  $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
                AuthenticationTokenInvalidSession:
                  $ref: "#/components/examples/AuthenticationTokenInvalidSessionErrorExample"
                AuthenticationTokenSessionMismatch:
                  $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
                AuthenticationTokenInvalidToken:
                  $ref: "#/components/examples/AuthenticationTokenInvalidTokenErorrExample"
                AuthenticationTokenExpired:
                  $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
                  - $ref: "#/components/schemas/MagicLinkTokenTypeError"
                  - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidSessionError"
                  - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
                  - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
                  - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
  /mfa/setup:
    get:
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Retrieve temporary TOTP secret and QR code for MFA setup
      description: |
        Initiates the setup process for Multi-Factor Authentication (MFA) using TOTP (Time-Based One-Time Password). 
        Returns a temporary secret key and a QR code that the user can scan in their authenticator app (e.g., Google Authenticator, Authy). 
        The temporary secret must be verified by the user to finalize MFA enrollment. 
        This endpoint requires the user to be authenticated via a valid access token cookie.
      security:
        - AccessTokenCokie: []
      responses:
        "200":
          description: >
            MFA setup initiated successfully. Returns a temporary TOTP secret and a Base64-encoded QR code image. 
            The client should display the QR code to the user for scanning in their authenticator app.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MfaSetupResponse"
        "409":
          description: >
            Conflict. MFA is already enabled for this user. No new temporary secret is generated. 
            The user should proceed to login with MFA or disable MFA before attempting to setup again.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MfaAlreadyEnabledError"
        "401":
          $ref: "#/components/responses/InvalidAccessJwtToken"
        "403":
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
  /mfa/verify:
    post:
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
      summary: Verify the MFA code for a user
      description: >
        Verifies the multi-factor authentication (MFA) code provided by the user.
        This step is required after MFA setup or during a login flow to validate
        the one-time code generated by the authenticator app or sent via email/SMS.
        Upon successful verification, the MFA setup is confirmed or the login session is allowed.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              content:
                application/json:
                  schema:
                    type: object
                    required:
                      - code
                    properties:
                      code:
                        type: string
      responses:
        "200":
          summary: MFA verification successful
          description: >
            The provided MFA code was valid. The user's MFA setup is confirmed
            or the login session is authenticated. No further action is required.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAVerifySetupSuccessResponse"
        "409":
          summary: MFA already enabled
          description: >
            The user has already enabled MFA for their account. A new MFA setup cannot be created until the existing one is disabled.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MfaAlreadyEnabledError"
        "400":
          summary: Invalid MFA code or temporary secret expired
          description: >
            The MFA verification failed due to an invalid or expired code, or because the temporary secret generated during setup has expired. The user should request a new code or restart the MFA setup process.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              examples:
                MfaTemporarySecretExpired:
                  $ref: "#/components/examples/MfaTemporarySecretExpiredErrorExample"
                MfaInvalidverificationCode:
                  $ref: "#/components/examples/MfaInvalidverificationCodeErrorExample"
              schema:
                oneOf:
                  - $ref: "#/components/schemas/MfaTemporarySecretExpiredError"
                  - $ref: "#/components/schemas/MfaInvalidverificationCodeError"
        "401":
          $ref: "#/components/responses/InvalidAccessJwtToken"
        "403":
          description: >
            Forbidden. The user is authenticated but is not allowed to perform the requested MFA action. 
            This typically occurs when the user does not have a password-based login method configured, 
            which is required to enable Multi-Factor Authentication (2FA). 
            The client should prompt the user to add a password-based login (e.g., via "Forgot Password") 
            before attempting MFA setup.
          headers:
            X-Request-Id:
              $ref: "#/components/headers/XRequestId"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MFAForbiddenError"
  /mfa/revoke:
    post:
      tags: [ðŸ•¹ï¸Multi Factor Authentication Endpoints]
components:
  # REPONSES
  responses:
    # TOKEN UNAUTHORIZED RESPONSES
    InvalidAccessJwtToken:
      description: >
        Unauthorized. The request could not be authenticated because the provided token 
        is invalid, expired, or cannot be used for the current session. 
        Possible reasons include:
        - The token does not exist or was already used (AuthenticationTokenNotFound).
        - The token type is incorrect or not supported (AccessTokenTypeError).
        - The token does not belong to a valid user (AuthenticationTokenUserNotFoundError).
        - The user's session is invalid, expired, or has been terminated (AuthenticationTokenInvalidSessionError).
        - The token does not match the current session or context (AuthenticationTokenSessionMismatchError).
        - The token is malformed or otherwise invalid (AuthenticationTokenInvalidTokenError).
        - The token has expired and is no longer usable (AuthenticationTokenExpiredError).
      headers:
        X-Request-Id:
          $ref: "#/components/headers/XRequestId"
      content:
        application/json:
          schema:
            oneOf:
              - $ref: "#/components/schemas/AuthenticationTokenNotFoundError"
              - $ref: "#/components/schemas/AccessTokenTypeError"
              - $ref: "#/components/schemas/AuthenticationTokenUserNotFoundError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidSessionError"
              - $ref: "#/components/schemas/AuthenticationTokenSessionMismatchError"
              - $ref: "#/components/schemas/AuthenticationTokenInvalidTokenErorr"
              - $ref: "#/components/schemas/AuthenticationTokenExpiredError"
          examples:
            AuthenticationTokenNotFound:
              $ref: "#/components/examples/AuthenticationTokenNotFoundErrorExample"
            AccessTokenType:
              $ref: "#/components/examples/AccessTokenTypeErrorExample"
            AuthenticationTokenUserNotFound:
              $ref: "#/components/examples/AuthenticationTokenUserNotFoundErrorExample"
            AuthenticationTokenInvalidSession:
              $ref: "#/components/examples/AuthenticationTokenInvalidSessionErrorExample"
            AuthenticationTokenSessionMismatch:
              $ref: "#/components/examples/AuthenticationTokenSessionMismatchErrorExample"
            AuthenticationTokenInvalidToken:
              $ref: "#/components/examples/AuthenticationTokenInvalidTokenErorrExample"
            AuthenticationTokenExpired:
              $ref: "#/components/examples/AuthenticationTokenExpiredErrorExample"
  # SCHEMAS
  schemas:
    # REUSABLE DATA
    UserData:
      type: object
      required:
        - _id
        - name
        - email
        - isEmailVerified
        - userPreferences
        - createdAt
        - updatedAt
      properties:
        _id:
          type: string
          example: 6904fb216bdaf225b3726294
        name:
          type: string
          example: user
        email:
          type: string
          example: marinescua914@gmail.com
        isEmailVerified:
          type: boolean
          example: false
        userPreferences:
          type: object
          required:
            - enable2FA
            - emailNotification
          properties:
            enable2FA:
              type: boolean
              example: false
            emailNotification:
              type: boolean
              example: true
        createdAt:
          type: string
          format: date-time
          example: 2025-10-31T18:08:33.919Z
        updatedAt:
          type: string
          format: date-time
          example: 2025-10-31T18:08:33.919Z
    ResponseMetadata:
      type: object
      required:
        - timestamp
        - requestId
      properties:
        timestamp:
          type: string
          format: date-time
          example: 2025-10-31T18:08:35.135Z
        requestId:
          type: string
          example: 627c83c6ac314a94bd9348d78
        count:
          type: number
    # REQUEST BODY
    UserRegistrationRequestBody:
      type: object
      required:
        - name
        - email
        - password
        - confirmPassword
      properties:
        name:
          type: string
          description: The user's full name
          minLength: 1
          maxLength: 64
          example: John Doe
        email:
          type: string
          format: email
          minLength: 1
          maxLength: 64
          example: john.doe@example.com
        password:
          type: string
          minLength: 8
          pattern: ^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{}|\\;:\'",.<>/?]).{8,}$
          description: Must start with a capital letter and contain at least one special character
          example: Password@123
        confirmPassword:
          type: string
          minLength: 8
          pattern: ^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{}|\\;:\'",.<>/?]).{8,}$
          description: Must match the password field
          example: Password@123
    UserLoginRequestBody:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          minLength: 1
          maxLength: 64
          example: john.doe@example.com
        password:
          type: string
          minLength: 8
          pattern: ^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{}|\\;:\'",.<>/?]).{8,}$
          description: Must start with a capital letter and contain at least one special character
          example: Password@123
    ForgotPasswordRequestBody:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          example: john.doe@gmail.com
    ResetPasswordRequestBody:
      type: object
      required:
        - verificationCode
        - password
      properties:
        verificationCode:
          type: string
          minLength: 1
          maxLength: 64
          example: 8ee6af17747140d8951121739
        password:
          type: string
          minLength: 8
          pattern: ^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{}|\\;:\'",.<>/?]).{8,}$
          description: Must start with a capital letter and contain at least one special character
          example: Password@123
    MagicLinkSignUpRequestBody:
      type: object
      required:
        - name
        - email
      properties:
        name:
          type: string
          description: The user's full name
          minLength: 1
          maxLength: 64
          example: John Doe
        email:
          type: string
          format: email
          minLength: 1
          maxLength: 64
          example: john.doe@example.com
    MagicLinkSignInRequestBody:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          minLength: 1
          maxLength: 64
          example: john.doe@example.com
    # RESPONSES
    RegistrationSuccessReponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [201]
          example: 201
        message:
          type: string
          example: Registration successful. A verification email has been sent to your email address.
        data:
          type: object
          properties:
            user:
              $ref: "#/components/schemas/UserData"
            isVerificationEmailSend:
              type: boolean
              example: true
            nextStep:
              type: string
              enum: ["CONFIRM_SIGN_UP"]
              example: CONFIRM_SIGN_UP
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    LoginEmailVerificationPendingResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Authentication pending, your email address has not yet been verified. Please confirm your email to proceed.
        data:
          type: object
          properties:
            nextStep:
              type: string
              enum: ["CONFIRM_SIGN_UP"]
              example: CONFIRM_SIGN_UP
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    LoginSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Authentication successful, you have been signed in successfully.
        data:
          type: object
          required:
            - mfaRequired
            - nextStep
            - user
          properties:
            user:
              $ref: "#/components/schema/UserData"
            nextStep:
              type: string
              enum: ["OK"]
              example: OK
            mfaRequired:
              type: boolean
              enum: [false]
              example: false
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    MFAPendingResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Two-factor authentication required. Please enter your verification code to complete this process.
        data:
          type: object
          required:
            - mfaRequired
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["MFA_REQUIRED"]
              example: MFA_REQUIRED
            mfaRequired:
              type: boolean
              enum: [true]
              example: true
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    EmailConfirmedSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Email address successfully verified. You can now proceed to login.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["CONFIRMED_EMAIL_RETURN_TO_LOGIN"]
              example: CONFIRMED_EMAIL_RETURN_TO_LOGIN
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    ForgotPasswordSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Password reset request successfully processed. Please check your email for further instructions.
        data:
          type: object
          required:
            - nextStep
            - mfaRequired
          properties:
            nextStep:
              type: string
              enum: ["OK"]
              example: OK
            mfaRequired:
              type: boolean
              enum: [false]
              example: false
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    ResetPasswordSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Password reset completed. If you didnâ€™t request this change, please contact support immediately.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["OK"]
              example: OK
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    RefreshTokenEndpointSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Access token successfully refreshed. Your session remains active.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["OK"]
              example: OK
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    LogoutSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: Logout successful, you have been securely signed out.
        data:
          type: object
          required:
            - nextStep
          properties:
            nextStep:
              type: string
              enum: ["LOGOUT"]
              example: LOGOUT
          metadata:
            $ref: "#/components/schemas/ResponseMetadata"
    MagicLinkSignUpSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [201]
          example: 201
        message:
          type: string
          example: We've sent a magic link to your email. Click it to successfully finish your registration process.
        data:
          type: object
          properties:
            user:
              $ref: "#/components/schemas/UserData"
            isMagicLinkEmailSend:
              type: boolean
              example: true
            nextStep:
              type: string
              enum: ["CHECK_EMAIL_FOR_MAGIC_LINK"]
              example: CHECK_EMAIL_FOR_MAGIC_LINK
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    MagicLinkSignInSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: We've sent a magic link to your email. Click it to successfully finish your registration process.
        data:
          type: object
          properties:
            isMagicLinkEmailSend:
              type: boolean
              example: true
            nextStep:
              type: string
              enum: ["CHECK_EMAIL_FOR_MAGIC_LINK"]
              example: CHECK_EMAIL_FOR_MAGIC_LINK
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    MfaSetupResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: We've sent a magic link to your email. Click it to successfully finish your registration process.
        data:
          type: object
          required:
            - secret
            - qrImageUrl
          properties:
            secret:
              type: string
              description: Base32-encoded TOTP secret for the user. This secret is used to generate OTP codes.
              pattern: "^[A-Z2-7]+=*$"
              example: "JBSWY3DPEHPK3PXP"
            qrImageUrl:
              type: string
              description: Base64-encoded PNG image of the QR code for TOTP setup. Can be rendered in clients as an image.
              format: byte
              example: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..."
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    MFAVerifySetupSuccessResponse:
      type: object
      required:
        - success
        - statusCode
        - message
        - data
        - metadata
      properties:
        success:
          type: boolean
          enum: [true]
          example: true
        statusCode:
          type: integer
          enum: [200]
          example: 200
        message:
          type: string
          example: MFA setup completed successfully.
        data:
          type: object
          required:
            - userPreferences
          properties:
            userPreferences:
              type: object
              required:
                - enabled2FA
                - backupCodes
              properties:
                enable2FA:
                  type: boolean
                  enum: [true]
                  example: true
                backupCodes:
                  type: array
                  items:
                    type: string
                    example:
                    - "4F9K2M8Q1"
                    - "A7B3C1D9E"
                    - "X2Y5Z8W1Q"
                    - "9G1H3J7K2"
                    - "L4M6N8O2P"
                    - "Q7R2S9T3V"
                    - "3B8F1D6H2"
                    - "Z5X9C2V7L"
        metadata:
          $ref: "#/components/schemas/ResponseMetadata"
    # ERRORS
    # GENERAL ERRORS
    InternalServerError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Internal Server Error
        errorCode:
          type: string
          enum: ["INTERNAL_SERVER_ERROR"]
          example: INTERNAL_SERVER_ERROR
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    ForbiddenError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Access denied, you do not have permission to perform this action.
        errorCode:
          type: string
          enum: ["ACCESS_FORBIDDEN"]
          example: ACCESS_FORBIDDEN
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    TooManyRequestsError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Too many requests. Please try again later.
        errorCode:
          type: string
          enum: ["TOO_MANY_REQUESTS"]
          example: TOO_MANY_REQUESTS
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    EmailServiceError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Failed to send the email. Please try again later.
        errorCode:
          type: string
          enum: ["EMAIL_SERVICE_ERROR"]
          example: EMAIL_SERVICE_ERROR
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    InvalidRequestBodyValidationError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
        - errors
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Validation failed, some fields in the request body did not meet the expected format or constraints.
        errorCode:
          type: string
          enum: ["VALIDATION_ERROR_INVALID_REQUEST_BODY"]
          example: VALIDATION_ERROR_INVALID_REQUEST_BODY
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
        errors:
          type: array
          minItems: 1
          items:
            type: object
            required:
              - field
              - message
            properties:
              field:
                type: string
              message:
                type: string
          example:
            - field: email
              message: Invalid email address
            - field: password
              message: Password must be at least 8 characters
    # EMAIL & PASS ERRORS
    EmailAlreadyExistsError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Registration failed, this email address is already associated with an existing account.
        errorCode:
          type: string
          enum: ["AUTH_EMAIL_ALREADY_EXISTS"]
          example: AUTH_EMAIL_ALREADY_EXISTS
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    UserNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: User with the specified email was not found.
        errorCode:
          type: string
          enum: ["AUTH_USER_NOT_FOUND"]
          example: AUTH_USER_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    InvalidCredentialsError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Invalid credentials. Please check your email and password and try again.
        errorCode:
          type: string
          enum: ["AUTH_INVALID_CREDENTIALS"]
          example: AUTH_INVALID_CREDENTIALS
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasswordReuseNotAllowed:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: You cannot reuse a previous password. Please choose a new one.
        errorCode:
          type: string
          enum: ["AUTH_PASSWORD_REUSE_NOT_ALLOWED"]
          example: AUTH_PASSWORD_REUSE_NOT_ALLOWED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # VERFICATION CODES
    VerificationCodeNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Invalid or non-existent verification code. Please request a new one.
        errorCode:
          type: string
          enum: ["VERIFICATION_CODE_ERROR_CODE_NOT_FOUND"]
          example: VERIFICATION_CODE_ERROR_CODE_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    VerificationCodeExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: This verification code has expired. Please request a new one to continue.
        errorCode:
          type: string
          enum: ["VERIFICATION_CODE_ERROR_CODE_EXPIRED"]
          example: VERIFICATION_CODE_ERROR_CODE_EXPIRED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    VerificationCodeConsumedError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: This verification code has already been used. Please request a new one if needed.
        errorCode:
          type: string
          enum: ["VERIFICATION_CODE_ERROR_CODE_CONSUMED"]
          example: VERIFICATION_CODE_ERROR_CODE_CONSUMED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # TOKEN GENERAL ERRORS
    AuthenticationTokenNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, no authentication token provided.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_NOT_FOUND"]
          example: AUTH_TOKEN_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenUserNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the user associated with this token does not exist.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_USER_NOT_FOUND"]
          example: AUTH_TOKEN_USER_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenInvalidSessionError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the token session is invalid, expired, or has already been consumed.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_SESSION_INVALID"]
          example: AUTH_TOKEN_SESSION_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenSessionMismatchError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the user ID in the JWT token does not match the user ID of the session.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_SESSION_MISMATCH"]
          example: AUTH_TOKEN_SESSION_MISMATCH
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenInvalidTokenErorr:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
        message:
          type: string
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_INVALID"]
        requestId:
          type: string
      examples:
        jwtMalformed:
          summary: Token is malformed
          value:
            success: false
            message: "Authentication failed: jwt malformed"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
        invalidSignature:
          summary: Token signature is invalid
          value:
            success: false
            message: "Authentication failed: invalid signature"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
        tokenMissing:
          summary: Token is missing
          value:
            success: false
            message: "Authentication failed: jwt must be provided"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
        invalidAudience:
          summary: Token audience does not match
          value:
            success: false
            message: "Authentication failed: invalid audience"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
        invalidIssuer:
          summary: Token issuer is invalid
          value:
            success: false
            message: "Authentication failed: invalid issuer"
            errorCode: AUTH_TOKEN_INVALID
            requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, jwt expired at 2025-11-02T18:00:00Z.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_EXPIRED"]
          example: AUTH_TOKEN_EXPIRED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # ACCESS TOKEN
    AccessTokenTypeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, expected an ACCESS token, but received a token of a different type.
        errorCode:
          type: string
          enum: ["AUTH_ACCESS_TOKEN_TYPE_INVALID"]
          example: AUTH_ACCESS_TOKEN_TYPE_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # MFA TOKEN
    MFATokenTypeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, expected an MFA token, but received a token of a different type.
        errorCode:
          type: string
          enum: ["AUTH_MFA_TOKEN_TYPE_INVALID"]
          example: AUTH_MFA_TOKEN_TYPE_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MFATokenInvalidEndpointError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, MFA token was sent to an invalid or unsupported endpoint.
        errorCode:
          type: string
          enum: ["AUTH_MFA_INVALID_ENDPOINT"]
          example: AUTH_MFA_INVALID_ENDPOINT
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MFATokenInvalidTokenPurposeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, MFA token purpose mismatch. Expected 'login', got 'forgot_password'.
        errorCode:
          type: string
          enum: ["AUTH_TOKEN_INVALID_TYPE"]
          example: AUTH_TOKEN_INVALID_TYPE
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MFAForbiddenError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: You do not have permission to perform this action. To benefit of 2FA, please add a password-based login method in your account settings first. (choose forgot password).
        errorCode:
          type: string
          enum: ["ACCESS_FORBIDDEN"]
          example: ACCESS_FORBIDDEN
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # MAGIC LINK TOKEN
    MagicLinkTokenTypeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, expected an MAGIC-LINK token, but received a token of a different type.
        errorCode:
          type: string
          enum: ["AUTH_MAGIC_LINK_TOKEN_TYPE_INVALID"]
          example: AUTH_MAGIC_LINK_TOKEN_TYPE_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # REFRESH TOKEN
    RefreshTokenTypeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, expected an REFRESH token, but received a token of a different type.
        errorCode:
          type: string
          enum: ["AUTH_REFRESH_TOKEN_TYPE_INVALID"]
          example: AUTH_REFRESH_TOKEN_TYPE_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    RefreshTokenInvalidSessionError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the refresh token session does not exist or is invalid. Please log in again.
        errorCode:
          type: string
          enum: ["AUTH_REFRESH_TOKEN_SESSION_INVALID"]
          example: AUTH_REFRESH_TOKEN_SESSION_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    RefreshTokenExpiredSessionError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the refresh token session has expired. Please log in again to obtain a new refresh token.
        errorCode:
          type: string
          enum: ["AUTH_REFRESH_TOKEN_SESSION_EXPIRED"]
          example: AUTH_REFRESH_TOKEN_SESSION_EXPIRED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # MFA
    MfaAlreadyEnabledError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Two-factor authentication is already enabled. No further action is required.
        errorCode:
          type: string
          enum: ["MFA_ALREADY_ENABLED"]
          example: MFA_ALREADY_ENABLED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MfaAlreadyDisabledError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Two-factor authentication is already disabled. No further action is required.
        errorCode:
          type: string
          enum: ["MFA_ALREADY_DISABLED"]
          example: MFA_ALREADY_DISABLED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MfaTemporarySecretExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Temporary TOTP secret expired. Please generate a new QR code to configure 2FA.
        errorCode:
          type: string
          enum: ["MFA_EXPIRED_TEMP_SECRET"]
          example: MFA_EXPIRED_TEMP_SECRET
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MfaInvalidverificationCodeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: The MFA code you entered is incorrect or has expired. Please request a new code to complete the verification.
        errorCode:
          type: string
          enum: ["MFA_INVALID_VERIFICATION_CODE"]
          example: MFA_INVALID_VERIFICATION_CODE
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    MfaNotEnabledError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Cannot verify MFA because two-factor authentication is not enabled for this account.
        errorCode:
          type: string
          enum: ["MFA_NOT_ENABLED"]
          example: MFA_NOT_ENABLED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    InvalidBackupCodeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: The backup code you entered is invalid or has already been used. Please try a different one.
        errorCode:
          type: string
          enum: ["BACKUPCODE_INVALID_CODE"]
          example: BACKUPCODE_INVALID_CODE
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # OIDC
    OIDCSessionNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, no valid OIDC session was found for the given state and provider.
        errorCode:
          type: string
          enum: ["OIDC_SESSION_NOT_FOUND"]
          example: OIDC_SESSION_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    OIDCSessionExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the OIDC session has expired. Please restart the sign-in process.
        errorCode:
          type: string
          enum: ["OIDC_SESSION_CONSUMED"]
          example: OIDC_SESSION_CONSUMED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    OIDCSessionConsumedError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the OIDC session has already been used and cannot be reused.
        errorCode:
          type: string
          enum: ["OIDC_SESSION_CONSUMED"]
          example: OIDC_SESSION_CONSUMED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    OIDCFailedAuthenticationError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed while communicating with the external identity provider. Please try again or use a different sign-in method.
        errorCode:
          type: string
          enum: ["OIDC_FAILED_AUTHENTIFICATION"]
          example: OIDC_FAILED_AUTHENTIFICATION
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # PASSKEY
    PasskeyChallengeSessionNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey registration session was not found or is invalid. Please restart the passkey process.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALLENGE_SESSION_INVALID"]
          example: PASSKEY_CHALLENGE_SESSION_INVALID
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionConsumedError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey session has already been used. Please restart the passkey process.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALLENGE_SESSION_CONSUMED"]
          example: PASSKEY_CHALLENGE_SESSION_CONSUMED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionInvalidPurposeError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey session purpose does not match the expected type. Please restart the passkey process.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALLENGE_SESSION__INVALID_PURPOSE"]
          example: PASSKEY_CHALLENGE_SESSION__INVALID_PURPOSE
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionExpiredError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey session has expired. Please restart the passkey process.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALLENGE_SESSION__EXPIRED"]
          example: PASSKEY_CHALLENGE_SESSION__EXPIRED
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeVerificationError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the passkey verification could not be completed successfully. Please ensure you are using the correct passkey and try again.
        errorCode:
          type: string
          enum: ["PASSKEY_CHALENGE_VERIFICATION_ERROR"]
          example: PASSKEY_CHALENGE_VERIFICATION_ERROR
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    PasskeyNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: Authentication failed, the provided passkey could not be found or is invalid. Please remove this passkey from your device and register a new one.
        errorCode:
          type: string
          enum: ["PASSKEY_NOT_FOUND"]
          example: PASSKEY_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
    # SESSIONS
    UserSessionNotFoundError:
      type: object
      required:
        - success
        - message
        - errorCode
        - requestId
      properties:
        success:
          type: boolean
          enum: [false]
          example: false
        message:
          type: string
          example: The session associated with this operation could not be found.
        errorCode:
          type: string
          enum: ["AUTH_SESSION_NOT_FOUND"]
          example: AUTH_SESSION_NOT_FOUND
        requestId:
          type: string
          example: cc5065df0c6b4c19970d4e92f
  # EXAMPLES
  examples:
    # SUCCESS RESPONSES
    LoginEmailVerificationPendingResponseExample:
      summary: Login pending due to unverified email
      value:
        success: true
        statusCode: 200
        message: Authentication pending, your email address has not yet been verified. Please confirm your email to proceed.
        data:
          nextStep: CONFIRM_SIGN_UP
        metadata:
          requestId: 627c83c6ac314a94bd9348d78
          timestamp: 2025-10-31T18:08:35.135Z
    LoginSuccessResponseExample:
      summary: Login successful without MFA
      value:
        success: true
        statusCode: 200
        message: Authentication successful, You have been signed in successfully.
        data:
          user:
            _id: 6904fb216bdaf225b3726294
            name: user
            email: marinescua914@gmail.com
            isEmailVerified: true
            userPreferences:
              enable2FA: false
              emailNotification: true
            createdAt: 2025-10-31T18:08:33.919Z
            updatedAt: 2025-10-31T18:08:33.919Z
          nextStep: OK
          mfaRequired: false
        metadata:
          requestId: 627c83c6ac314a94bd9348d78
          timestamp: 2025-10-31T18:08:35.135Z
    MFAPendingResponseExample:
      summary: Login pending requiring MFA
      value:
        success: true
        statusCode: 200
        message: Two-factor authentication required. Please enter your verification code to complete this process.
        data:
          nextStep: MFA_REQUIRED
          mfaRequired: true
        metadata:
          requestId: 627c83c6ac314a94bd9348d78
          timestamp: 2025-10-31T18:08:35.135Z
    ForgotPasswordSuccessResponseExample:
      summary: Password reset request successfully processed
      value:
        success: true
        statusCode: 200
        message: Password reset request successfully processed. Please check your email for further instructions.
        data:
          nextStep: OK
          mfaRequired: false
        metadata:
          requestId: 627c83c6ac314a94bd9348d78
          timestamp: 2025-10-31T18:08:35.135Z
    # ERRORS
    # GENERAL ERRORS
    InternalServerErrorExample:
      summary: Internal server error
      value:
        success: false
        message: Internal Server Error
        errorCode: INTERNAL_SERVER_ERROR
        requestId: cc5065df0c6b4c19970d4e92f
    ForbiddenErrorExample:
      summary: Access forbidden
      value:
        success: false
        message: Access denied, you do not have permission to perform this action.
        errorCode: ACCESS_FORBIDDEN
        requestId: cc5065df0c6b4c19970d4e92f
    TooManyRequestsErrorExample:
      summary: Too many requests
      value:
        success: false
        message: Too many requests. Please try again later.
        errorCode: TOO_MANY_REQUESTS
        requestId: cc5065df0c6b4c19970d4e92f
    EmailServiceErrorExample:
      summary: Email service failure
      value:
        success: false
        message: Failed to send the email. Please try again later.
        errorCode: EMAIL_SERVICE_ERROR
        requestId: cc5065df0c6b4c19970d4e92f
    InvalidRequestBodyValidationErrorExample:
      summary: Invalid request body
      value:
        success: false
        message: Validation failed, some fields in the request body did not meet the expected format or constraints.
        errorCode: VALIDATION_ERROR_INVALID_REQUEST_BODY
        requestId: cc5065df0c6b4c19970d4e92f
        errors:
          - field: email
            message: Invalid email address
          - field: password
            message: Password must be at least 8 characters
    # EMAIL & PASS ERRORS
    EmailAlreadyExistsErrorExample:
      summary: Email already exists
      value:
        success: false
        message: Registration failed, this email address is already associated with an existing account.
        errorCode: AUTH_EMAIL_ALREADY_EXISTS
        requestId: cc5065df0c6b4c19970d4e92f
    UserNotFoundErrorExample:
      summary: User not found
      value:
        success: false
        message: User with the specified email was not found.
        errorCode: AUTH_USER_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    InvalidCredentialsErrorExample:
      summary: Invalid credentials
      value:
        success: false
        message: Invalid credentials. Please check your email and password and try again.
        errorCode: AUTH_INVALID_CREDENTIALS
        requestId: cc5065df0c6b4c19970d4e92f
    PasswordReuseNotAllowedExample:
      summary: Password reuse not allowed
      value:
        success: false
        message: You cannot reuse a previous password. Please choose a new one.
        errorCode: AUTH_PASSWORD_REUSE_NOT_ALLOWED
        requestId: cc5065df0c6b4c19970d4e92f
    # VERFICATION CODES
    VerificationCodeNotFoundErrorExample:
      summary: Verification code not found
      value:
        success: false
        message: Invalid or non-existent verification code. Please request a new one.
        errorCode: VERIFICATION_CODE_ERROR_CODE_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    VerificationCodeExpiredErrorExample:
      summary: Verification code expired
      value:
        success: false
        message: This verification code has expired. Please request a new one to continue.
        errorCode: VERIFICATION_CODE_ERROR_CODE_EXPIRED
        requestId: cc5065df0c6b4c19970d4e92f
    VerificationCodeConsumedErrorExample:
      summary: Verification code already consumed
      value:
        success: false
        message: This verification code has already been used. Please request a new one if needed.
        errorCode: VERIFICATION_CODE_ERROR_CODE_CONSUMED
        requestId: cc5065df0c6b4c19970d4e92f
    # TOKEN GENERAL ERRORS
    AuthenticationTokenNotFoundErrorExample:
      summary: Authentication token not found
      value:
        success: false
        message: Authentication failed, no authentication token provided.
        errorCode: AUTH_TOKEN_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenUserNotFoundErrorExample:
      summary: User associated with token not found
      value:
        success: false
        message: Authentication failed, the user associated with this token does not exist.
        errorCode: AUTH_TOKEN_USER_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenInvalidSessionErrorExample:
      summary: Invalid token session
      value:
        success: false
        message: Authentication failed, the token session is invalid, expired, or has already been consumed.
        errorCode: AUTH_TOKEN_SESSION_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenSessionMismatchErrorExample:
      summary: Token session mismatch
      value:
        success: false
        message: Authentication failed, the user ID in the JWT token does not match the user ID of the session.
        errorCode: AUTH_TOKEN_SESSION_MISMATCH
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenExpiredErrorExample:
      summary: Token expired
      value:
        success: false
        message: Authentication failed, jwt expired at 2025-11-02T18:00:00Z.
        errorCode: AUTH_TOKEN_EXPIRED
        requestId: cc5065df0c6b4c19970d4e92f
    AuthenticationTokenInvalidErrorExample:
      summary: Invalid token
      value:
        success: false
        message: >
          Authentication failed. Possible reasons:
          - jwt malformed
          - invalid signature
          - jwt must be provided
          - invalid audience
          - invalid issuer
        errorCode: AUTH_TOKEN_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    # ACCESS
    AccessTokenTypeErrorExample:
      summary: Invalid access token type
      value:
        success: false
        message: Authentication failed, expected an ACCESS token, but received a token of a different type.
        errorCode: AUTH_ACCESS_TOKEN_TYPE_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    # MFA TOKEN
    MFATokenTypeErrorExample:
      summary: Invalid MFA token type
      value:
        success: false
        message: Authentication failed, expected an MFA token, but received a token of a different type.
        errorCode: AUTH_MFA_TOKEN_TYPE_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    MFATokenInvalidEndpointErrorExample:
      summary: MFA token sent to invalid endpoint
      value:
        success: false
        message: Authentication failed, MFA token was sent to an invalid or unsupported endpoint.
        errorCode: AUTH_MFA_INVALID_ENDPOINT
        requestId: cc5065df0c6b4c19970d4e92f
    MFATokenInvalidTokenPurposeErrorExample:
      summary: MFA token purpose mismatch
      value:
        success: false
        message: Authentication failed, MFA token purpose mismatch. Expected 'login', got 'forgot_password'.
        errorCode: AUTH_TOKEN_INVALID_TYPE
        requestId: cc5065df0c6b4c19970d4e92f
    # MAGIC LINK TOKEN
    MagicLinkTokenTypeErrorExample:
      summary: Invalid magic link token type
      value:
        success: false
        message: Authentication failed, expected an MAGIC-LINK token, but received a token of a different type.
        errorCode: AUTH_MAGIC_LINK_TOKEN_TYPE_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    # REFRESH TOKEN
    RefreshTokenTypeErrorExample:
      summary: Invalid refresh token type
      value:
        success: false
        message: Authentication failed, expected an REFRESH token, but received a token of a different type.
        errorCode: AUTH_REFRESH_TOKEN_TYPE_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    RefreshTokenInvalidSessionErrorExample:
      summary: Refresh token session invalid
      value:
        success: false
        message: Authentication failed, the refresh token session does not exist or is invalid. Please log in again.
        errorCode: AUTH_REFRESH_TOKEN_SESSION_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    RefreshTokenExpiredSessionErrorExample:
      summary: Refresh token session expired
      value:
        success: false
        message: Authentication failed, the refresh token session has expired. Please log in again to obtain a new refresh token.
        errorCode: AUTH_REFRESH_TOKEN_SESSION_EXPIRED
        requestId: cc5065df0c6b4c19970d4e92f
    # MFA
    MfaAlreadyEnabledErrorExample:
      summary: MFA already enabled
      value:
        success: false
        message: Two-factor authentication is already enabled. No further action is required.
        errorCode: MFA_ALREADY_ENABLED
        requestId: cc5065df0c6b4c19970d4e92f
    MfaAlreadyDisabledErrorExample:
      summary: MFA already disabled
      value:
        success: false
        message: Two-factor authentication is already disabled. No further action is required.
        errorCode: MFA_ALREADY_DISABLED
        requestId: cc5065df0c6b4c19970d4e92f
    MfaTemporarySecretExpiredErrorExample:
      summary: Temporary TOTP secret expired
      value:
        success: false
        message: Temporary TOTP secret expired. Please generate a new QR code to configure 2FA.
        errorCode: MFA_EXPIRED_TEMP_SECRET
        requestId: cc5065df0c6b4c19970d4e92f
    MfaInvalidVerificationCodeErrorExample:
      summary: Invalid or expired MFA code
      value:
        success: false
        message: The MFA code you entered is incorrect or has expired. Please request a new code to complete the verification.
        errorCode: MFA_INVALID_VERIFICATION_CODE
        requestId: cc5065df0c6b4c19970d4e92f
    MfaNotEnabledErrorExample:
      summary: MFA not enabled
      value:
        success: false
        message: Cannot verify MFA because two-factor authentication is not enabled for this account.
        errorCode: MFA_NOT_ENABLED
        requestId: cc5065df0c6b4c19970d4e92f
    InvalidBackupCodeErrorExample:
      summary: Invalid or already used backup code
      value:
        success: false
        message: The backup code you entered is invalid or has already been used. Please try a different one.
        errorCode: BACKUPCODE_INVALID_CODE
        requestId: cc5065df0c6b4c19970d4e92f
    MFAForbiddenErrorExample:
      summary: User cannot perform MFA action due to missing password-based login
      value:
        success: false
        message: "You do not have permission to perform this action. To benefit of 2FA, please add a password-based login method in your account settings first. (choose forgot password)."
        errorCode: ACCESS_FORBIDDEN
        requestId: cc5065df0c6b4c19970d4e92f
    # OIDC
    OIDCSessionNotFoundErrorExample:
      summary: OIDC session not found
      value:
        success: false
        message: Authentication failed, no valid OIDC session was found for the given state and provider.
        errorCode: OIDC_SESSION_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    OIDCSessionExpiredErrorExample:
      summary: OIDC session expired
      value:
        success: false
        message: Authentication failed, the OIDC session has expired. Please restart the sign-in process.
        errorCode: OIDC_SESSION_CONSUMED
        requestId: cc5065df0c6b4c19970d4e92f
    OIDCSessionConsumedErrorExample:
      summary: OIDC session already used
      value:
        success: false
        message: Authentication failed, the OIDC session has already been used and cannot be reused.
        errorCode: OIDC_SESSION_CONSUMED
        requestId: cc5065df0c6b4c19970d4e92f
    OIDCFailedAuthenticationErrorExample:
      summary: OIDC failed authentication
      value:
        success: false
        message: Authentication failed while communicating with the external identity provider. Please try again or use a different sign-in method.
        errorCode: OIDC_FAILED_AUTHENTIFICATION
        requestId: cc5065df0c6b4c19970d4e92f
    # PASSKEY
    PasskeyChallengeSessionNotFoundErrorExample:
      summary: Passkey challenge session not found
      value:
        success: false
        message: Authentication failed, the passkey registration session was not found or is invalid. Please restart the passkey process.
        errorCode: PASSKEY_CHALLENGE_SESSION_INVALID
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionConsumedErrorExample:
      summary: Passkey challenge session already used
      value:
        success: false
        message: Authentication failed, the passkey session has already been used. Please restart the passkey process.
        errorCode: PASSKEY_CHALLENGE_SESSION_CONSUMED
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionInvalidPurposeErrorExample:
      summary: Passkey challenge session purpose invalid
      value:
        success: false
        message: Authentication failed, the passkey session purpose does not match the expected type. Please restart the passkey process.
        errorCode: PASSKEY_CHALLENGE_SESSION__INVALID_PURPOSE
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeSessionExpiredErrorExample:
      summary: Passkey challenge session expired
      value:
        success: false
        message: Authentication failed, the passkey session has expired. Please restart the passkey process.
        errorCode: PASSKEY_CHALLENGE_SESSION__EXPIRED
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyChallengeVerificationErrorExample:
      summary: Passkey verification failed
      value:
        success: false
        message: Authentication failed, the passkey verification could not be completed successfully. Please ensure you are using the correct passkey and try again.
        errorCode: PASSKEY_CHALENGE_VERIFICATION_ERROR
        requestId: cc5065df0c6b4c19970d4e92f
    PasskeyNotFoundErrorExample:
      summary: Passkey not found
      value:
        success: false
        message: Authentication failed, the provided passkey could not be found or is invalid. Please remove this passkey from your device and register a new one.
        errorCode: PASSKEY_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
    #SESSIONS
    UserSessionNotFoundErrorExample:
      summary: User session not found
      value:
        success: false
        message: The session associated with this operation could not be found.
        errorCode: AUTH_SESSION_NOT_FOUND
        requestId: cc5065df0c6b4c19970d4e92f
  # HEADERS
  headers:
    XRequestId:
      description: Unique request identifier for tracing and debugging
      schema:
        type: string
      examples:
        default:
          value: "627c83c6ac314a94bd9348d78"
    AuthenticationCookies:
      description: |
        Multiple cookies may be set in this response:
        1. accessToken â€” HTTP-only access token
        2. refreshToken â€” HTTP-only refresh token
        3. mfaToken â€” HTTP-only MFA token (if required)
      schema:
        type: string
      examples:
        default:
          value: |
            accessToken=eyJhbGciOi...; Path=/; HttpOnly; Secure; SameSite=Strict; Expires=Wed, 03 Nov 2025 20:00:00 GMT,
            refreshToken=eyJhbGciOi...; Path=/auth/refresh; HttpOnly; Secure; SameSite=Strict; Expires=Wed, 03 Nov 2025 20:00:00 GMT
            mfaToken=eyJhbGciOi...; Path=/mfa; HttpOnly; Secure; SameSite=Strict; Expires=Wed, 03 Nov 2025 20:00:00 GMT
    MFATokenCookie:
      description: |
        HTTP-only MFA token cookie used for two-factor authentication.
        This cookie must be included in subsequent requests to complete the MFA step.
      schema:
        type: string
      examples:
        default:
          value: |
            mfaToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...; Path=/mfa; HttpOnly; Secure; SameSite=Strict; Expires=Wed, 03 Nov 2025 20:00:00 GMT
    InvalidateAuthenticationCookies:
      description: |
        Multiple authentication cookies may be cleared in this response to invalidate any existing sessions.
        This ensures that previously issued tokens become unusable and the user must log in again.
        The following cookies are invalidated:
        1. accessToken â€” HTTP-only access token
        2. refreshToken â€” HTTP-only refresh token
      schema:
        type: string
      examples:
        default:
          value: |
            accessToken=; Path=/; HttpOnly; Secure; SameSite=Strict; Expires=Thu, 01 Jan 1970 00:00:00 GMT
            refreshToken=; Path=/auth/refresh; HttpOnly; Secure; SameSite=Strict; Expires=Thu, 01 Jan 1970 00:00:00 GMT
  # SECURITY
  securitySchemes:
    AccessTokenCokie:
      type: apiKey
      in: cookie
      name: accessToken
    RefreshTokenCokie:
      type: apiKey
      in: cookie
      name: accessToken
